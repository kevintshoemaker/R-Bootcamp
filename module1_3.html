<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Getting started: basic plotting and statistics in R" />


<title>Module 1.3</title>

<script src="site_libs/header-attrs-2.10/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/journal.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R bootcamp, Fall 2021</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Bootcamp #1: getting started
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="module1_1.html">Submodule 1.1: working with objects</a>
    </li>
    <li>
      <a href="module1_2.html">Submodule 1.2: managing data</a>
    </li>
    <li>
      <a href="module1_3.html">Submodule 1.3: plotting and basic stats</a>
    </li>
    <li>
      <a href="module1_4.html">Submodule 1.4: Programming in R</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Bootcamp #2: Beyond the basics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="module2_1.html">Submodule 2.1: R packages</a>
    </li>
    <li>
      <a href="module2_2.html">Submodule 2.2: Using the 'tidyverse'</a>
    </li>
    <li>
      <a href="module2_3.html">Submodule 2.3: Plotting with 'ggplot'</a>
    </li>
    <li>
      <a href="module2_4.html">Submodule 2.4: Parallel computing in R</a>
    </li>
    <li>
      <a href="module2_5.html">Submodule 2.5: Spatial analysis</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Data sets
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="data.dat">Example: tab-separated data</a>
    </li>
    <li>
      <a href="data.csv">Example: comma-separated data</a>
    </li>
    <li>
      <a href="data.txt">Example: whitespace-separated data</a>
    </li>
    <li>
      <a href="data_missing.txt">Example: missing data</a>
    </li>
    <li>
      <a href="MTMetStations.csv">Meteorological Data</a>
    </li>
    <li>
      <a href="sculpineggs.csv">Sculpin Data</a>
    </li>
    <li>
      <a href="turtle_data.txt">Turtle Data</a>
    </li>
    <li>
      <a href="geneData.csv">Gene Data</a>
    </li>
    <li>
      <a href="reptiles.csv">Reptile Data</a>
    </li>
    <li>
      <a href="data.zip">GIS Data</a>
    </li>
  </ul>
</li>
<li>
  <a href="Links.html">Links</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Module 1.3</h1>
<h4 class="author">Getting started: basic plotting and statistics in R</h4>
<h4 class="date">Fall 2021</h4>

</div>


<p>NOTE: this module borrows heavily from an R short course developed by a team at Colorado State University.<br />
- Thanks to Perry Williams for allowing us to use these materials!!<br />
- Thanks to John Tipton at CSU for developing much of this module (plotting in R)!</p>
<div id="load-script-for-module-1.3-plotting" class="section level2">
<h2>Load script for module #1.3: Plotting</h2>
<ol style="list-style-type: decimal">
<li><p>Click <a href="module1_3.R">here</a> to download the script! Save the script to your working directory (R Project folder).</p></li>
<li><p>Load your script in your RStudio Project. To do this, open your RStudio Project and click on the folder icon in the toolbar at the top and load your script.</p></li>
</ol>
<p>Let’s get started with plotting in R!</p>
<p>We’ll start with the ‘trees’ dataset, which is built into R. It describes the girth, height, and volume of 31 felled black cherry trees.</p>
<pre class="r"><code># ?trees      # description of built in dataset  (uncomment to run)

dim(trees)   # Show the dimension of the trees dataframe                                              </code></pre>
<pre><code>## [1] 31  3</code></pre>
<pre class="r"><code>str(trees)   # Show the structure of the trees dataframe</code></pre>
<pre><code>## &#39;data.frame&#39;:    31 obs. of  3 variables:
##  $ Girth : num  8.3 8.6 8.8 10.5 10.7 10.8 11 11 11.1 11.2 ...
##  $ Height: num  70 65 63 72 81 83 66 75 80 75 ...
##  $ Volume: num  10.3 10.3 10.2 16.4 18.8 19.7 15.6 18.2 22.6 19.9 ...</code></pre>
<pre class="r"><code>head(trees)   # Show the first few observations of the trees dataframe</code></pre>
<pre><code>##   Girth Height Volume
## 1   8.3     70   10.3
## 2   8.6     65   10.3
## 3   8.8     63   10.2
## 4  10.5     72   16.4
## 5  10.7     81   18.8
## 6  10.8     83   19.7</code></pre>
<pre class="r"><code># Access the columns 
trees$Girth     
trees$Volume</code></pre>
</div>
<div id="basic-plots" class="section level2">
<h2>Basic plots</h2>
<p>R’s basic “plot()” function takes an “x” argument (defining coordinates on an x axis) and a “y” argument (defining coordinates on a y axis).</p>
<p>Here is an example of a <strong>scatterplot</strong> in R:</p>
<pre class="r"><code>plot(x=trees$Girth, y=trees$Volume)    # use R&#39;s built-in &quot;trees&quot; dataset: ?trees</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<div id="change-plot-type" class="section level3">
<h3>Change Plot Type</h3>
<p>Because we’re exploring different ways of plotting, it is useful to include multiple plots in the same image.</p>
<p>We can do this using the <code>par()</code> function (graphical parameters), which has arguments that control just about every aspect of a plot in R.</p>
<pre class="r"><code>?par

par()   # view the default graphical parameters (can be kind of overwhelming!)</code></pre>
<p>We could change the “mfrow” parameter from c(1,1) to c(2,2): this means that we can fit four plots into a single window.</p>
<p>An even easier solution is to use the convenience function <code>layout()</code>. An example using <code>layout()</code> is below.</p>
<p>The default plot type for two quantitative variables is points (classic scatterplot), but you can change it to lines or both points and lines (or others) by using the <code>type=</code> option:</p>
<pre class="r"><code># Use &quot;layout&quot; to define a 2 row x 2 column matrix with elements 1, 2, 3, and 4.
# This divides the image into four sections and then fills these with the plot function
layout(matrix(1:4, nrow=2, ncol=2))

# layout.show(4)   # uncomment to run

  # par(mfrow=c(2,2))  # (alternative way to do this)

plot(x=trees$Girth, y=trees$Volume)             # points
plot(x=trees$Girth, y=trees$Volume, type=&quot;l&quot;)   # lines
plot(x=trees$Girth, y=trees$Volume, type=&quot;b&quot;)   # both
plot(x=trees$Girth, y=trees$Volume, type=&quot;o&quot;)   # both with conected lines</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Whenever you use <code>layout()</code> or <code>par()</code>, the graphics window will retain this layout for all future plots. To start over (and return to the default graphical parameters), use <code>graphics.off()</code> to reset the plot. For example:</p>
<pre class="r"><code>plot(x=trees$Girth, y=trees$Volume)             ## The plot is still in 4 parts

graphics.off()                                  ## now the plot is reset!

# layout(1)   # (alternative way to reset back to a single plot)

plot(x=trees$Girth, y=trees$Volume)             ## The plot is still in 4 parts</code></pre>
</div>
<div id="change-plot-symbol" class="section level3">
<h3>Change Plot Symbol</h3>
<p>We can also change the type of points used when plotting using the <code>pch=</code> option. For example, we plot three different shape options below:</p>
<pre class="r"><code># Use layout to define a 3 row x 1 column matrix with elements 1, 2, and 3.
# This divides the image into three sections and then fills these with the plot function
layout(matrix(1:3, nrow=3, ncol=1))

# pch: &#39;plotting character&#39; changes the type of point that is used (default is an open circle)!
plot(x=trees$Girth, y=trees$Volume, pch=19)     # filled point
plot(x=trees$Girth, y=trees$Volume, pch=2)      # open triangle
plot(x=trees$Girth, y=trees$Volume, pch=11)     # star</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>You might want to remember a couple favorites (for example, I like to use pch=20). Alternatively, you might consider saving a useful guide like this:</p>
<p><img src="points.png" /></p>
</div>
<div id="specify-title-and-axes" class="section level3">
<h3>Specify Title and Axes</h3>
<p>We can also add titles, axis labels, and other options to make the plots look pretty. For example, we show below how each plot is changed by the addition of one extra command, starting at the top left corner and moving top-to-bottom:</p>
<pre class="r"><code>layout(matrix(1:4, 2, 2))
# main: adds a title
plot(x=trees$Girth, y=trees$Volume, pch=19, 
     main=&quot;Girth vs. Volume for Black Cherry Trees&quot;)

# xlab: adds an x axis label
plot(x=trees$Girth, y=trees$Volume, pch=19, 
     main=&quot;Girth vs. Volume for Black Cherry Trees&quot;, 
     xlab=&quot;Tree Girth (in)&quot;)

# ylab: adds a y axis label
plot(x=trees$Girth, y=trees$Volume, pch=19, 
     main=&quot;Girth vs. Volume for Black Cherry Trees&quot;, 
     xlab=&quot;Tree Girth (in)&quot;, ylab=&quot;Tree Volume (cu ft)&quot;)

# las: rotates axis labels; las=1 makes them all parallel to reading direction
plot(x=trees$Girth, y=trees$Volume, pch=19, 
     main=&quot;Girth vs. Volume for Black Cherry Trees&quot;, 
     xlab=&quot;Tree Girth (in)&quot;, ylab=&quot;Tree Volume (cu ft)&quot;, 
     las=1)</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="add-colors" class="section level3">
<h3>Add Colors</h3>
<p>If we want we can add colors to the points in the plot as well using the <code>col=</code> option. We will also use the <code>layout()</code> function to make a more interesting plot</p>
<pre class="r"><code># Use layout to define a 2 row x 2 column matrix with elements 1, 1, 2, and 3.
# This divides the image into four sections but fills the first two sections
# with the first plot and then fills these next two sections with the final two plots
layout(matrix(c(1, 1, 2, 3), nrow=2, ncol=2))

# col: select a color for the plotting characters
plot(x=trees$Girth, y=trees$Volume, pch=19, 
     main=&quot;Girth vs. Volume for Black Cherry Trees&quot;,
     xlab=&quot;Tree Girth (in)&quot;, ylab=&quot;Tree Volume (cu ft)&quot;,
     las=1, col=&quot;blue&quot;)

# We can use the c() function to make a vector and have several colors, plotting characters, etc. per plot.
# We start with alternating colors for each point
plot(x=trees$Girth, y=trees$Volume, pch=19, 
     main=&quot;Girth vs. Volume for Black Cherry Trees&quot;,
     xlab=&quot;Tree Girth (in)&quot;, ylab=&quot;Tree Volume (cu ft)&quot;, 
     las=1, col=c(&quot;black&quot;, &quot;blue&quot;))

# And we can also alternate the plotting symbol at each point.
plot(x=trees$Girth, y=trees$Volume, pch=c(1,19), 
     main=&quot;Girth vs. Volume for Black Cherry Trees&quot;, 
     xlab=&quot;Tree Girth (in)&quot;, ylab=&quot;Tree Volume (cu ft)&quot;, 
     las=1, col=&quot;blue&quot;)</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
</div>
<div id="plotting-by-group" class="section level2">
<h2>Plotting By Group</h2>
<p>In our previous plot, we alternated colors between points - wouldn’t it be awesome to use color to distinguish between groups in the data? To do this, we look at the <code>iris</code> dataset. This dataset describes the sepal length, sepal width, petal length, petal width, and species for 150 different irises representing 3 different species (<em>I. setosa</em>, <em>I. versicolor</em>, <em>I. virginica</em>) . First we look at the data:</p>
<pre class="r"><code>?iris</code></pre>
<pre><code>## starting httpd help server ... done</code></pre>
<pre class="r"><code>head(iris)     # display first few rows of data</code></pre>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa</code></pre>
<pre class="r"><code>dim(iris)      # dimensionality of the data</code></pre>
<pre><code>## [1] 150   5</code></pre>
<pre class="r"><code>str(iris)      # details of the data structure</code></pre>
<pre><code>## &#39;data.frame&#39;:    150 obs. of  5 variables:
##  $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...
##  $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...
##  $ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...
##  $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...
##  $ Species     : Factor w/ 3 levels &quot;setosa&quot;,&quot;versicolor&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
<p>We will use the <code>col=</code> option of our <code>plot()</code> function.</p>
<p>First we will define a new object with the three colors that we want to use. You can use any colors you like (Google “R color chart”, or just click <a href="http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf">here</a>)</p>
<pre class="r"><code>plot.colors &lt;- c(&quot;violet&quot;, &quot;purple&quot;, &quot;blue&quot;)   # define the colors for representing species ID</code></pre>
<p>At this point, you could “cheat” if you notice that there are exactly 50 observations for each species in the iris dataset, and that all observations are grouped together neatly by species. That is, you could just use the repeat function, <code>rep()</code> with the argument <code>each=50</code>, to create a new vector <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> with each color in our <code>plot.colors</code> vector repeated 50 times in sequence.</p>
<pre class="r"><code>color.vector &lt;- rep(x=plot.colors, each=50)
color.vector
## color vector is now a list of our colors, each repeated 50 times

plot(x=iris$Petal.Length, y=iris$Sepal.Length, pch=19, col=color.vector, 
     main=&quot;Plot of Iris colored by species&quot;)</code></pre>
<p><img src="module1_3_files/figure-html/colorvector-1.png" width="672" /></p>
<p>But … <strong>this is not good programming practice!!</strong>. We want to make our code general (if you get new data you don’t want to re-write your code) and fool-proof and the above code is neither general (it applies only to this data set) nor fool-proof (there is no guarantee that it is correct- it’s based only on an eyeballing approach!).</p>
<div id="a-better-method" class="section level3">
<h3>A better method!</h3>
<p>What if we want to automate the process? This is always a good idea because it makes your code more general and easier to use the next time you need to make a plot. Our strategy here is to directly match the ‘Species’ column with the “plot.colors” vector.</p>
<p>Our first step might be to name each element of our plot colors vector to match the species names:</p>
<pre class="r"><code>names(plot.colors) &lt;- levels(iris$Species)   # the &quot;levels()&quot; function returns all unique labels for any &quot;factor&quot; variable    
plot.colors</code></pre>
<pre><code>##     setosa versicolor  virginica 
##   &quot;violet&quot;   &quot;purple&quot;     &quot;blue&quot;</code></pre>
<p>Now, each color is associated with a species. We can now use a logical operation to generate a vector of colors for our plot:</p>
<pre class="r"><code># generate a vector of colors for our plot (one color for each observation)

indices &lt;- match(iris$Species,names(plot.colors))   # the &quot;match()&quot; function goes through each element of the first vector and finds the matching index in the second vector         
color.vector2 &lt;- plot.colors[indices]</code></pre>
<p>Now we can use our new color vector in our plotting!</p>
<pre class="r"><code>plot(x=iris$Petal.Length, y=iris$Sepal.Length, pch=19, col=color.vector2, 
     main=&quot;Iris sepal length vs. petal length&quot;, xlab=&quot;Petal length&quot;, 
     ylab=&quot;Sepal length&quot;, las=1)</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>To illustrate how general our new method is, let’s make a new version of the iris data frame that is neither in order nor has the same number of observations for each species:</p>
<pre class="r"><code># make a new version of the iris data frame that is neither in order nor has the same number of observations for each species (to illustrate generality of the new method)

iris2 &lt;- iris[sample(1:nrow(iris),replace = T),]   # use the &quot;sample()&quot; function to create a randomized (&quot;bootstrapped&quot;) version of the iris data frame

# now repeat the above steps:

indices &lt;- match(iris2$Species,names(plot.colors))   # the &quot;match()&quot; function returns the indices of the first vector that match the second vector   
color.vector2 &lt;- plot.colors[indices]
plot(x=iris2$Petal.Length, y=iris2$Sepal.Length, pch=19, col=color.vector2, 
     main=&quot;Iris sepal length vs. petal length&quot;, xlab=&quot;Petal length&quot;, 
     ylab=&quot;Sepal length&quot;, las=1)</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>Whereas, if we used our first method, the colors would be all over the map, and not representing species anymore (or any other useful information)!</p>
<pre class="r"><code>## The old method is NOT general:

color.vector &lt;- rep(x=plot.colors, each=50)
plot(x=iris2$Petal.Length, y=iris2$Sepal.Length, pch=19, col=color.vector, 
     main=&quot;Plot of Iris colored by species (not!)&quot;)</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
</div>
</div>
<div id="add-a-legend" class="section level2">
<h2>Add a Legend</h2>
<p>We use the <code>legend()</code> function to add a legend to an existing plot. You can customize the legend if you wish. Here I pass a character vector to the <code>legend=</code> argument so that I can include the first letter of the genus in the second plot and use the <code>bty='n'</code> argument to remove the box around the legend. We can also Italicize the labels in the legend using <code>text.font=3</code>, as in the third plot.</p>
<pre class="r"><code>########
# experiment with legends

# ?legend

layout(matrix(1:3, nrow=1, ncol=3))

# Plot
plot(x=iris$Petal.Length, y=iris$Sepal.Length, pch=19, col=color.vector, 
     main=&quot;Iris sepal length vs. petal length&quot;, xlab=&quot;Petal length&quot;, 
     ylab=&quot;Sepal length&quot;, las=1)

# First legend
legend(&quot;topleft&quot;, pch=19, col=plot.colors, legend=unique(iris$Species))

# Second plot
plot(x=iris$Petal.Length, y=iris$Sepal.Length, pch=19, col=color.vector,
     main=&quot;Iris sepal length vs. petal length&quot;, 
     xlab=&quot;Petal length&quot;, ylab=&quot;Sepal length&quot;, las=1)

# Second legend
# The bty=&quot;n&quot; argument suppresses the border around the legend. (A personal preference)
legend(&quot;topleft&quot;, pch=19, col=plot.colors, 
       legend=c(&quot;I. setosa&quot;, &quot;I. versicolor&quot;, &quot;I. virginica&quot;), bty=&quot;n&quot;)


# Plot Three
plot(x=iris$Petal.Length, y=iris$Sepal.Length, pch=19, col=color.vector, 
     main=&quot;Iris sepal length vs. petal length&quot;, 
     xlab=&quot;Petal length&quot;, ylab=&quot;Sepal length&quot;, las=1)

#Legend tree with Italics
legend(&quot;topleft&quot;, pch=19, col=plot.colors, 
       legend=c(&quot;I. setosa&quot;, &quot;I. versicolor&quot;, &quot;I. virginica&quot;), 
       bty=&quot;n&quot;, text.font=3)</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
</div>
<div id="diplaying-gradients-continuous-data-using-color-and-size" class="section level2">
<h2>Diplaying gradients (continuous data) using color and size</h2>
<p>To illustrate some other cool ways to convey information graphically in R, let’s turn to the “mtcars” dataset (which comes with base R):</p>
<pre class="r"><code>## Diplaying gradients (continuous data) using color and size

?mtcars

head(mtcars)</code></pre>
<p>First, let’s plot fuel economy (mpg) as a function of vehicle weight:</p>
<pre class="r"><code>## Plot fuel economy by weight

plot(mpg~wt,  data=mtcars,pch=20,xlab=&quot;Vehicle weight (1000 lbs)&quot;,ylab=&quot;Fuel economy (mpg)&quot;)      # note the tilde, which can be read &quot;as a function of&quot; -- i.e., &quot;plot mpg as a function of wt&quot;   </code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>Now what if we want to look at another factor that might influence fuel economy: gross horsepower. We might imagine that cars with greater horsepower within a weight class will tend to have lower fuel economy. One way to do this is to use the size of the dots to indicate horsepower…</p>
<pre class="r"><code>## Plot fuel economy by weight and horsepower

hp_rescale &lt;- with(mtcars,(hp-min(hp))/diff(range(hp)))    # scale from 0 to 1

plot(mpg~wt,  data=mtcars,pch=1,xlab=&quot;Vehicle weight (1000 lbs)&quot;,ylab=&quot;Fuel economy (mpg)&quot;,cex=(hp_rescale+0.6)*1.2)   # plot with different sized points

legend(&quot;topright&quot;,pch=c(1,1),pt.cex=c(0.6,0.6*1.2),legend=paste(range(mtcars$hp),&quot;horsepower&quot;),bty=&quot;n&quot;)</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>Another way to display this would be to use colors!</p>
<pre class="r"><code>## Plot fuel economy by weight and horsepower again- this time by color

colramp &lt;- terrain.colors(125)

colindex &lt;- round(hp_rescale*99+1)

plot(mpg~wt,  data=mtcars,pch=20,cex=2,xlab=&quot;Vehicle weight (1000 lbs)&quot;,ylab=&quot;Fuel economy (mpg)&quot;,col=colramp[colindex])   # plot with different sized points

legend(&quot;topright&quot;,pch=c(20,20),pt.cex=c(2,2),col=c(colramp[1],colramp[100]),legend=paste(range(mtcars$hp),&quot;horsepower&quot;),bty=&quot;n&quot;)</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
</div>
<div id="bar-plots" class="section level2">
<h2>Bar Plots</h2>
<pre class="r"><code>## calculate the mean Sepal Length of for each species
bar.heights &lt;- tapply(iris$Sepal.Length, iris$Species, mean)   #use &quot;tapply()&quot; function, which summarizes a numeric variable by levels of a categorical variable)

# The basic &#39;barplot()&#39; function
barplot(bar.heights)</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>Using the <code>barplot()</code> options (arguments), we can make this look fancier</p>
<pre class="r"><code># Let&#39;s add some flair
barplot(bar.heights, names.arg=c(&quot;I. setosa&quot;, &quot;I. versicolor&quot;, &quot;I. virginica&quot;), 
        las=1, col=adjustcolor(plot.colors, alpha.f=0.5),
        main=&quot;Sepal length for 3 Irises&quot;, ylab=&quot;Sepal length (cm)&quot;)</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="error-bars" class="section level2">
<h2>Error bars</h2>
<p>Adding error bars to our barplot. These can be added to scatter plots in a similar way. We’ll plot error bars representing 2 standard deviations from the expected value. The object that you called your barplot (<code>b</code>) is interpreted by R as the x values in the middle of each bar <code>b</code> (which are very hard to guess, as you’ll see!).</p>
<p>We’ll use the <code>arrows()</code> function to add arrows to an existing plot. With some modifications, our arrows will have an arrowhead at each end (<code>code=3</code>), and the ‘arrowhead’ will actually be perpendicular to the arrow shaft (<code>angle=90</code>)</p>
<pre class="r"><code>CI &lt;- 2 * tapply(iris$Sepal.Length, iris$Species, sd)
lwr &lt;- bar.heights - CI
upr &lt;- bar.heights + CI

# I used the ylim= argument to pass a 2-element numeric vector specifying the y extent of the barplot (y axis lower and upper bounds). I added some extra room on the top to account for error bars.
# Importantly, assign the barplot to an object. I called it &#39;b&#39; but you can call it whatever you like. (otherwise, it&#39;s hard to know what the &quot;X&quot; values of the error bars are!)

b &lt;- barplot(bar.heights, 
             names.arg=c(&quot;I. setosa&quot;, &quot;I. versicolor&quot;, &quot;I. virginica&quot;), 
             las=1, ylim=c(0,8), col=adjustcolor(plot.colors, alpha.f=0.5),
             main=&quot;Sepal length for 3 Irises&quot;, ylab=&quot;Sepal length (cm)&quot;)

# Specify where each arrow starts (x0= and y0=) and ends (x1= and y1=)
arrows(x0=b, x1=b, y0=lwr, y1=upr, code=3, angle=90, length=0.1)</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<pre class="r"><code># ?arrows</code></pre>
</div>
<div id="histograms" class="section level2">
<h2>Histograms</h2>
<p>We can also use histograms to explore our data.</p>
<pre class="r"><code>layout(matrix(1:2, 1, 2))

## y-axis is in counts by default (total observations in each &quot;bin&quot;)
hist(iris$Sepal.Length, main=&quot;Histogram of Sepal Length&quot;,
     xlab = &quot;Sepal Length&quot;)

## change y-axis to proportions of the entire dataset using freq=FALSE
hist(iris$Sepal.Length, freq=FALSE, main=&quot;Histogram of Sepal Length&quot;, 
     xlab = &quot;Sepal Length&quot;)
## Add a density estimator

lines(density(iris$Sepal.Length))   # add a line to the histogram to approximate the probability density of the data distribution
curve(dnorm(x,mean(iris$Sepal.Length),sd(iris$Sepal.Length)),add=T,col=&quot;red&quot;,lty=3)   # add a normal distribution</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
</div>
<div id="pairs-plots" class="section level2">
<h2>Pairs Plots</h2>
<p>The <code>pairs()</code> function allows for quick investigation into relationships between variables. Be careful if your data set is large (e.g., lots of columns), as this can be a slow function.</p>
<pre class="r"><code>pairs(iris)</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
</div>
<div id="challenge-yourself-by-recreating-the-following-plots" class="section level2">
<h2>Challenge Yourself by recreating the following plots:</h2>
<p>Feel free to work in groups!</p>
<div id="using-colors" class="section level3">
<h3>Using colors</h3>
<p>Using the <code>ToothGrowth</code> dataset built into <code>R</code>, plot the tooth length (the <code>len</code> variable) as a function of the vitamin C dosage (the <code>dose</code> variable). Use a different color for each method of administering the vitamin C (the <code>supp</code> variable). Try and re-create the plot below:</p>
<pre class="r"><code>?ToothGrowth
head(ToothGrowth)</code></pre>
<pre><code>##    len supp dose
## 1  4.2   VC  0.5
## 2 11.5   VC  0.5
## 3  7.3   VC  0.5
## 4  5.8   VC  0.5
## 5  6.4   VC  0.5
## 6 10.0   VC  0.5</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
</div>
<div id="bar-plots-challenge" class="section level3">
<h3>Bar Plots Challenge</h3>
<p>The following data represent survival of plant seedlings in 4 different treatments: ambient, watered, heated + watered, and heated. Make a bar plot with their 95% confidence intervals. Note these are asymmetric (more uncertainty above the mean than below), like what might come from a logistic regression model. Try and re-create the plot below:</p>
<pre class="r"><code>prop &lt;- c(0.18, 0.25, 0.13, 0.05)
asympLCL &lt;- c(0.14, 0.20, 0.11, 0.035)
asympUCL &lt;- c(0.24, 0.33, 0.18, 0.09)</code></pre>
<p><img src="plantsurv1.png" /></p>
</div>
<div id="scatterplot-challenge-error-bars" class="section level3">
<h3>Scatterplot Challenge Error Bars</h3>
<p>The randomly generated data below are measurements of the number of the number of angels who get their wings as a function of the number of bells that have been rung. There is some uncertainty in measuring wing acquisition (represented as the offset from the sampled mean). How would you add error bars to a scatter plot? See if you can re-create the plot below:</p>
<pre class="r"><code>set.seed(13)
n &lt;- 20 # Number of experimental trials
a &lt;- 12
b &lt;- 1.5

rings &lt;- round(runif(n)*50)  # number of bell rings
wings &lt;- round(a + b*rings + rnorm(n, sd=5))       # number of angels who get their wings
offset &lt;- rpois(n, lambda=10)           # measurement error
lwr &lt;- wings - offset                 
upr &lt;- wings + offset</code></pre>
<p><img src="ringswings1.png" /></p>
</div>
</div>
<div id="basic-statistics" class="section level2">
<h2>Basic statistics!</h2>
<p>This bootcamp is NOT an intro to statistics!</p>
<p>But, R is an environment developed for statistical computing, so let’s run some basic statistics in R!</p>
<div id="load-data" class="section level3">
<h3>Load data</h3>
<p>First, download the sculpin eggs data <a href="sculpineggs.csv">here</a> and save this to your working directory.</p>
<pre class="r"><code>####################
# STATISTICS!
####################

#####
#####  Load Data
#####

sculpin.df &lt;- read.csv(&quot;sculpineggs.csv&quot;)

head(sculpin.df)</code></pre>
<pre><code>##   FEMWT NUMEGGS
## 1    14      61
## 2    17      37
## 3    24      65
## 4    25      69
## 5    27      54
## 6    33      93</code></pre>
</div>
<div id="summary-statistics" class="section level3">
<h3>Summary statistics</h3>
<p>Let’s start by generating summary statistics, some of which are the same ones that are displayed by the “summary()” function. Most of the function names are pretty intuitive, like mean() and median():</p>
<pre class="r"><code>#####
#####  Summary Statistics
#####

mean(sculpin.df$NUMEGGS)      # compute sample mean</code></pre>
<pre><code>## [1] 76.54545</code></pre>
<pre class="r"><code>median(sculpin.df$NUMEGGS)    # compute sample median</code></pre>
<pre><code>## [1] 87</code></pre>
<pre class="r"><code>min(sculpin.df$NUMEGGS)       # sample minimum</code></pre>
<pre><code>## [1] 37</code></pre>
<pre class="r"><code>max(sculpin.df$NUMEGGS)       # sample maximum</code></pre>
<pre><code>## [1] 100</code></pre>
<pre class="r"><code>range(sculpin.df$NUMEGGS)     # both min and max.</code></pre>
<pre><code>## [1]  37 100</code></pre>
<pre class="r"><code>quantile(sculpin.df$NUMEGGS,0.5)            # compute sample median using quantile function</code></pre>
<pre><code>## 50% 
##  87</code></pre>
<pre class="r"><code>quantile(sculpin.df$NUMEGGS,c(0.25,0.75))   # compute sample quartiles</code></pre>
<pre><code>##  25%  75% 
## 63.0 91.5</code></pre>
<pre class="r"><code>var(sculpin.df$NUMEGGS)           # sample variance</code></pre>
<pre><code>## [1] 418.8727</code></pre>
<pre class="r"><code>sd(sculpin.df$NUMEGGS)            # sample standard deviation</code></pre>
<pre><code>## [1] 20.46638</code></pre>
<pre class="r"><code>sd(sculpin.df$NUMEGGS)^2          # another way to compute variance</code></pre>
<pre><code>## [1] 418.8727</code></pre>
<pre class="r"><code>var(sculpin.df$NUMEGGS)^0.5       # another way to compute std. dev.</code></pre>
<pre><code>## [1] 20.46638</code></pre>
<pre class="r"><code>colMeans(sculpin.df)           # column mean of data frame</code></pre>
<pre><code>##    FEMWT  NUMEGGS 
## 30.36364 76.54545</code></pre>
<pre class="r"><code>apply(sculpin.df,2,mean)       # column mean of data frame   # note the use of the &quot;apply()&quot; function. </code></pre>
<pre><code>##    FEMWT  NUMEGGS 
## 30.36364 76.54545</code></pre>
<pre class="r"><code>apply(sculpin.df,2,median)     # column median of data frame</code></pre>
<pre><code>##   FEMWT NUMEGGS 
##      33      87</code></pre>
<pre class="r"><code>########
# Or just use the &quot;summary()&quot; function!

summary(sculpin.df) # provides a set of summary statistics for all columns in a data frame. </code></pre>
<pre><code>##      FEMWT          NUMEGGS      
##  Min.   :14.00   Min.   : 37.00  
##  1st Qu.:24.50   1st Qu.: 63.00  
##  Median :33.00   Median : 87.00  
##  Mean   :30.36   Mean   : 76.55  
##  3rd Qu.:38.50   3rd Qu.: 91.50  
##  Max.   :42.00   Max.   :100.00</code></pre>
<p>If your data have missing values (coded as ‘NA’ in R), some statistical functions won’t work properly unless you specify an “na.rm=TRUE” argument (click <a href="data_missing.txt">here</a> if you don’t already have the test dataset with missing values):</p>
<pre class="r"><code>###########
# Deal with missing data

newdf &lt;- read.table(file=&quot;data_missing.txt&quot;, sep=&quot;\t&quot;, header=T)  # load dataset with missing data

mean(newdf$Export)</code></pre>
<pre><code>## [1] NA</code></pre>
<pre class="r"><code>mean(newdf$Export,na.rm = TRUE)</code></pre>
<pre><code>## [1] 10.22222</code></pre>
</div>
<div id="visual-exploration" class="section level3">
<h3>Visual exploration</h3>
<p>Plots (see beginning of module) take data exploration to the next level- we can start to discern patterns and identify outliers visually, giving us cues for further analyses we might want to perform.</p>
<pre class="r"><code>#####
#####  Plot data 
#####

hist(sculpin.df$NUMEGGS)</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<pre class="r"><code>plot(x = sculpin.df$FEMWT,y = sculpin.df$NUMEGGS)</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-34-2.png" width="672" /></p>
</div>
<div id="linear-regression" class="section level3">
<h3>Linear Regression</h3>
<p>The plot above suggests a fairly strong relationship between sculpin weight (“FEMWT”) and number of eggs (“NUMEGGS”). Let’s try to model this relationship!</p>
<p>Note the use of the generic “summary()” function below, which returns something very different when the input object is a linear model vs. when the input object is a data frame!</p>
<p>Also note the use of the “predict()” function, which not only allows you to use the model to make predictions, but also reports the uncertainty bounds on these predictions (via confidence or prediction intervals).</p>
<pre class="r"><code>#####
#####  Linear Regression  
#####

m1 &lt;- lm(NUMEGGS ~ FEMWT, data=sculpin.df)      # fit linear regression model

m1                                      # view estimates of intercept and slope </code></pre>
<pre><code>## 
## Call:
## lm(formula = NUMEGGS ~ FEMWT, data = sculpin.df)
## 
## Coefficients:
## (Intercept)        FEMWT  
##       19.77         1.87</code></pre>
<pre class="r"><code>summary(m1)                             # view summary of fit</code></pre>
<pre><code>## 
## Call:
## lm(formula = NUMEGGS ~ FEMWT, data = sculpin.df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -16.2556  -3.8700   0.3543   4.5448  15.0538 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  19.7668    10.5497   1.874 0.093747 .  
## FEMWT         1.8700     0.3325   5.624 0.000324 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 10.15 on 9 degrees of freedom
## Multiple R-squared:  0.7785, Adjusted R-squared:  0.7539 
## F-statistic: 31.63 on 1 and 9 DF,  p-value: 0.0003242</code></pre>
<pre class="r"><code>summary(m1)$r.squared                   # extract R-squared</code></pre>
<pre><code>## [1] 0.7784851</code></pre>
<pre class="r"><code>confint(m1)                             # confidence intervals for intercept and slope</code></pre>
<pre><code>##                 2.5 %    97.5 %
## (Intercept) -4.098376 43.632008
## FEMWT        1.117797  2.622113</code></pre>
<pre class="r"><code>AIC(m1)                                 # report AIC (Akaike&#39;s Information Criterion, used to perform model selection) </code></pre>
<pre><code>## [1] 86.00155</code></pre>
<pre class="r"><code>plot(x = sculpin.df$FEMWT,y = sculpin.df$NUMEGGS)    # plot data
abline(m1)                                           # plot line of best fit</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<pre class="r"><code>########
# Use the &quot;predict()&quot; function!

FEMWT.pred &lt;- data.frame(FEMWT = 30)                   # create new data frame to predict number of eggs at FEMWT of 30
predict(m1,newdata=FEMWT.pred)                         # make prediction</code></pre>
<pre><code>##        1 
## 75.86547</code></pre>
<pre class="r"><code>predict(m1,newdata=FEMWT.pred,interval=&quot;confidence&quot;)   # make prediction and get confidence interval</code></pre>
<pre><code>##        fit      lwr      upr
## 1 75.86547 68.93463 82.79631</code></pre>
<pre class="r"><code>predict(m1,newdata=FEMWT.pred,interval=&quot;prediction&quot;)   # make prediction and get prediction interval</code></pre>
<pre><code>##        fit      lwr      upr
## 1 75.86547 51.87347 99.85748</code></pre>
</div>
<div id="model-selection-example" class="section level3">
<h3>Model selection example</h3>
<p>Sometimes we may be uncertain which model is “best”. In this case, we run a set of <strong>plausible models</strong> and compare these models using metrics of model fit and performance, like AIC or R-squared.</p>
<p>Note the use of the “I()” within the formula specification (i.e., the “[response] ~ [predictors]” statement). Using “I()” causes R to interpret what’s inside the parentheses literally (“as is”), instead of using R’s formula shorthands. For instance, you might try running a linear model (“lm()”) in the following two ways and see how the results differ!</p>
<p>Click <a href="http://faculty.washington.edu/jmiyamot/p448/hahnpr%20r%20formula%20notation.pdf">here</a> for more information on R’s formula notation.</p>
<pre class="r"><code>##########
#  Explore the use of the &quot;I()&quot; syntax to interpret mathematical expressions literally (as is) within formulas. 

mod_noI &lt;- lm(NUMEGGS ~ FEMWT^2, data=sculpin.df)                  # fit linear regression model. But the &quot;^2&quot; doesn&#39;t seem to do anything here? What happened?
summary(mod_noI)

mod_withI &lt;- lm(NUMEGGS ~ I(FEMWT^2), data=sculpin.df)                  # fit linear regression model
summary(mod_withI)</code></pre>
<p>Below we perform AIC model selection and also visualize the differences between these alternative linear models.</p>
<p>A flexible method for visualizing the fit of alternative linear models involves overlaying predictions from each model (using the “predict()” function) on a basic scatterplot:</p>
<pre class="r"><code>##################################
####  Model selection example ####
##################################

## Try to work through these examples and make sure you understand them before moving on to the challenge exercises.

m1 &lt;- lm(NUMEGGS ~ FEMWT, data=sculpin.df)                  # fit linear regression model
summary(m1)

m2 &lt;- lm(NUMEGGS ~ 1, data=sculpin.df)                      # fit linear regression with intercept only (mean model)
summary(m2)

m3 &lt;- lm(NUMEGGS ~ I(FEMWT^0.5), data=sculpin.df)           # fit linear regression with intercept and sqrt of FEMWT term
summary(m3)</code></pre>
<pre class="r"><code>plot(NUMEGGS ~ FEMWT,data=sculpin.df)                      # plot data
abline(m1,col=&quot;black&quot;)                                     # plot line of best fit
abline(m2,col=&quot;red&quot;)                                       # plot intercept only model

#########
#  Here&#39;s a flexible method for drawing any arbitrary non-linear relationship!
FEMWT.pred &lt;- data.frame(FEMWT = seq(10,45,by=0.1))        # create new data frame to predict number of eggs from FEMWT of 10 to 45 by increments of 0.1
NUMEGGS.pred &lt;- predict(m3,newdata=FEMWT.pred)             # make prediction using &quot;predict()&quot; function
lines(FEMWT.pred$FEMWT,NUMEGGS.pred,col=&quot;green&quot;)  # plot sqrt model (note the use of the &quot;lines()&quot; function to draw a line!)</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<pre class="r"><code>########
# Perform model selection!


#Compare models using AIC
AIC(m1)</code></pre>
<pre><code>## [1] 86.00155</code></pre>
<pre class="r"><code>AIC(m2)</code></pre>
<pre><code>## [1] 100.5815</code></pre>
<pre class="r"><code>AIC(m3)</code></pre>
<pre><code>## [1] 86.87398</code></pre>
<pre class="r"><code>#Compare models using R-squared
summary(m1)$r.squared </code></pre>
<pre><code>## [1] 0.7784851</code></pre>
<pre class="r"><code>summary(m2)$r.squared </code></pre>
<pre><code>## [1] 0</code></pre>
<pre class="r"><code>summary(m3)$r.squared </code></pre>
<pre><code>## [1] 0.7602009</code></pre>
<pre class="r"><code>#########
#  And finally, here&#39;s how you can draw a confidence interval or prediction interval around a regression relationship!

plot(NUMEGGS ~ FEMWT,data=sculpin.df)                      # plot data
NUMEGGS.confint &lt;- predict(m3,newdata=FEMWT.pred,interval=&quot;prediction&quot;)             # use &quot;predict()&quot; function to compute the prediction interval!
points(FEMWT.pred$FEMWT,NUMEGGS.confint[,&quot;fit&quot;],col=&quot;green&quot;,typ=&quot;l&quot;,lwd=2)  # plot fitted sqrt model
points(FEMWT.pred$FEMWT,NUMEGGS.confint[,&quot;lwr&quot;],col=&quot;green&quot;,typ=&quot;l&quot;,lty=2)  # plot fitted sqrt model
points(FEMWT.pred$FEMWT,NUMEGGS.confint[,&quot;upr&quot;],col=&quot;green&quot;,typ=&quot;l&quot;,lty=2)  # plot fitted sqrt model</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-38-2.png" width="672" /></p>
</div>
<div id="statistics-challenge-exercises" class="section level3">
<h3>Statistics challenge exercises</h3>
<p>1: Fit a linear regression model with NUMEGGS as the response and some other transformation of FEMWT (e.g., lm(NUMEGGS ~ I(FEMWT^3))) as the predictor.</p>
<p>2: Plot the data and the curve of best fit from #1. How does the model fit the data?</p>
<p>3: Fit a linear regression model with NUMEGGS as the response and with both a linear and quadratic effect of FEMWT (within the same formula).</p>
<p>4: Plot the data and the curve of best fit from #1 and #3. Compare the two models. Can you identify a “best model”? If so, which one?</p>
<p>5: Predict the number of eggs (along with prediction interval) for FEMWT=15 using the models you fit in #1 and #3.</p>
<p>How do the predictions compare?</p>
<p><a href="module2_1.html">–go to next module–</a></p>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>NOTE: the length of the color vector must match the length of the x and y vectors (here, Petal.Length and Sepal.Length). If this is not true, <code>R</code> will make up stuff (recycle the shorter vectors) to force them to be the same length, so make sure these vectors are the same size.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
