<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Plotting in R (ggplot)" />


<title>Submodule 1.3</title>

<script src="site_libs/header-attrs-2.24/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/journal.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">UNR R workshop, Fall 2023</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Workshop #1: getting started
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="module1_1.html">Submodule 1.1: working with objects</a>
    </li>
    <li>
      <a href="module1_2.html">Submodule 1.2: managing data</a>
    </li>
    <li>
      <a href="module1_3.html">Submodule 1.3: plotting in ggplot2</a>
    </li>
    <li>
      <a href="module1_4.html">Submodule 1.4: data wrangling</a>
    </li>
    <li>
      <a href="EXTRAS.html">Submodule 1.5: final demo</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Workshop #2: beyond the basics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="module2_1.html">Submodule 2.1: R packages</a>
    </li>
    <li>
      <a href="module2_2.html">Submodule 2.2: Programming in R</a>
    </li>
    <li>
      <a href="module2_3.html">Submodule 2.3: Stats in R</a>
    </li>
    <li>
      <a href="module2_4.html">Submodule 2.4: Spatial analysis in R</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Data sets
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="data.dat">Example: tab-separated data</a>
    </li>
    <li>
      <a href="data.csv">Example: comma-separated data</a>
    </li>
    <li>
      <a href="data.txt">Example: whitespace-separated data</a>
    </li>
    <li>
      <a href="data_missing.txt">Example: missing data</a>
    </li>
    <li>
      <a href="MTMetStations.csv">Meteorological Data</a>
    </li>
    <li>
      <a href="sculpineggs.csv">Sculpin Data</a>
    </li>
    <li>
      <a href="turtle_data.txt">Turtle Data</a>
    </li>
    <li>
      <a href="geneData.csv">Gene Data</a>
    </li>
    <li>
      <a href="reptiles.csv">Reptile Data</a>
    </li>
    <li>
      <a href="comm_data.txt">Comm Data</a>
    </li>
    <li>
      <a href="data.zip">GIS Data</a>
    </li>
  </ul>
</li>
<li>
  <a href="Links.html">Links</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Submodule 1.3</h1>
<h4 class="author">Plotting in R (ggplot)</h4>
<h4 class="date">Fall 2023</h4>

</div>


<p>Visualization often plays a major role in the research process, from
quality assurance, to data exploration, to the presentation of
results.</p>
<p>The data visualization package <em>ggplot2</em> makes it very easy
and straightforward to create a lot of different types of plots, from
simple to complex. In this module, we’ll introduce ggplot syntax and
briefly survey some of the package’s plotting capabilities.</p>
<p>A good ggplot cheat sheet can be found here: <a
href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/data-visualization.pdf">ggplot
cheat sheet</a></p>
<div id="load-script-for-submodule-1.3-plotting" class="section level2">
<h2>Load script for submodule #1.3: Plotting</h2>
<ol style="list-style-type: decimal">
<li><p>Click <a href="module1_3.R">here</a> to download the script, and
save the script to your working directory (R Project folder).</p></li>
<li><p>Load the script into your RStudio Project. To do this, open your
RStudio Project and click on the folder icon in the toolbar at the top
and load your script.</p></li>
</ol>
<p>Let’s get started with plotting in R!</p>
</div>
<div id="ggplot-basics" class="section level2">
<h2>ggplot basics</h2>
<p>A typical workflow begins with initiating plotting with the
<strong><code>ggplot()</code></strong> function and specifying the data
frame you want to use to create your visualizations. We then often
define the “x” argument (defining coordinates on an x axis) and (if
applicable) a “y” argument (defining coordinates on a y axis). In ggplot
these are known as aesthetic mappings! That is because it is a way of
conveying information in the dataset graphically! Other ways of
conveying information graphically include point size, color, and symbol-
all of which are also referred to as aesthetic mappings (syntax:
<code>mapping=aes()</code>).</p>
<p>You can then add geometric objects (like points) to your plot, often
using functions beginning with <strong><code>geom_</code></strong>, to
represent your data in the form of a boxplot
(<strong><code>geom_boxplot()</code></strong>), scatterplot
(<strong><code>geom_point()</code></strong>), or a variety of other
types of plots. The <strong><code>aes()</code></strong> function can be
called within these “geoms” to specify which variables to display and
how these data should be displayed (which data should be used to
represent the bar height, or the x coordinate, or the point size, etc.).
<strong><code>aes()</code></strong> can also be used within the initial
call to <strong><code>ggplot()</code></strong>.</p>
<p>Here is an example of a simple <strong>scatterplot</strong> in
ggplot:</p>
<pre class="r"><code># scatterplots ----------------------------

ggplot(trees, aes(x=Girth,y=Volume)) +
  geom_point()</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>We’ll start with the ‘trees’ dataset, which is built into R. It
describes the girth, height, and volume of 31 felled black cherry
trees.</p>
<pre class="r"><code># ASIDE: explore the built-in &#39;trees&#39; dataset

# ?trees      # description of built in dataset  (uncomment to run)

dim(trees)   # Show the dimension of the trees dataframe                                              </code></pre>
<pre><code>## [1] 31  3</code></pre>
<pre class="r"><code>str(trees)   # Show the structure of the trees dataframe</code></pre>
<pre><code>## &#39;data.frame&#39;:    31 obs. of  3 variables:
##  $ Girth : num  8.3 8.6 8.8 10.5 10.7 10.8 11 11 11.1 11.2 ...
##  $ Height: num  70 65 63 72 81 83 66 75 80 75 ...
##  $ Volume: num  10.3 10.3 10.2 16.4 18.8 19.7 15.6 18.2 22.6 19.9 ...</code></pre>
<pre class="r"><code>head(trees)   # Show the first few observations of the trees dataframe</code></pre>
<pre><code>##   Girth Height Volume
## 1   8.3     70   10.3
## 2   8.6     65   10.3
## 3   8.8     63   10.2
## 4  10.5     72   16.4
## 5  10.7     81   18.8
## 6  10.8     83   19.7</code></pre>
<pre class="r"><code>summary(trees)  # Summary stats for each column</code></pre>
<pre><code>##      Girth           Height       Volume     
##  Min.   : 8.30   Min.   :63   Min.   :10.20  
##  1st Qu.:11.05   1st Qu.:72   1st Qu.:19.40  
##  Median :12.90   Median :76   Median :24.20  
##  Mean   :13.25   Mean   :76   Mean   :30.17  
##  3rd Qu.:15.25   3rd Qu.:80   3rd Qu.:37.30  
##  Max.   :20.60   Max.   :87   Max.   :77.00</code></pre>
<p>And some more fancy and informative scatterplots</p>
<pre class="r"><code>    # try representing tree height using the color aesthetic
ggplot(trees, aes(x=Girth,y=Volume)) +
  geom_point(aes(col=Height))</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code>    # try representing tree height using the size aesthetic
ggplot(trees, aes(x=Girth,y=Volume)) +
  geom_point(aes(size=Height))</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-4-2.png" width="672" /></p>
<pre class="r"><code>   # try adding a regression line
ggplot(trees, aes(x=Girth,y=Volume)) +
  geom_point() +
  geom_smooth(method=&quot;lm&quot;)</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-4-3.png" width="672" /></p>
<div id="change-plot-type" class="section level3">
<h3>Change Plot Type</h3>
<p>Because we’re exploring different ways of plotting, it is useful to
include multiple plots in the same image.</p>
<p>We can do this using the <code>plot_grid()</code> function in the
cowplot package (commonly used extensions to ggplot). Here we explore
different ways of graphically representing the relationship between tree
girth and volume.</p>
<pre class="r"><code># Explore different &quot;geoms&quot; or plot types 

plot1 &lt;- ggplot(trees,aes(Girth,Volume)) +    # plot the relationship as a line
  geom_line()
plot2 &lt;- ggplot(trees,aes(Girth,Volume)) +    # plot a smoothed &quot;spline&quot; fit of the relationship
  geom_smooth()
plot3 &lt;- ggplot(trees,aes(Girth,Volume)) +    # plot scatterplot
  geom_point() 
plot4 &lt;- ggplot(trees,aes(Girth,Volume)) +    # plot scatterplot with smoothed regression line
  geom_point() + 
  geom_smooth()
plot_grid(plot1,plot2,plot3,plot4,labels=&quot;auto&quot;)</code></pre>
</div>
<div id="change-symbols-colors-and-point-sizes" class="section level3">
<h3>Change symbols, colors and point sizes</h3>
<p>Point shape is specified using the <code>shape=</code> option.</p>
<p>Color is specified using the <code>color=</code> option.</p>
<p>Size is specified using the <code>size=</code> option.</p>
<p>If you want convey information in your data via the color, symbol, or
point size, you include it as an aesthetic mapping- and link it to one
of the columns in your data.</p>
<p>If you just want to color all the points the same way, or use the
same symbol for everything, specify this outside of the aesthetic
mapping.</p>
<p>To illustrate this, let’s use the built in <code>iris</code> dataset,
which gives the sepal length/width and petal length/width (in cm), for
50 flowers from each of 3 iris species.</p>
<pre class="r"><code># Explore different aesthetic mappings 

plot1 &lt;- ggplot(iris,aes(Sepal.Length,Petal.Length)) +    # shape represents species
  geom_point(aes(shape=Species))
plot2 &lt;- ggplot(iris,aes(Sepal.Length,Petal.Length)) +       # shape is same for everything!
  geom_point(shape=2)
plot3 &lt;- ggplot(iris,aes(Sepal.Length,Petal.Length)) +    # color represents species
  geom_point(aes(color=Species)) 
plot4 &lt;- ggplot(iris,aes(Sepal.Length,Petal.Length)) +    # color is same across the board
  geom_point(col=&quot;purple&quot;)  
plot5 &lt;- ggplot(iris,aes(Sepal.Length,Petal.Length)) +    # size represents species
  geom_point(aes(size=Species)) 
plot6 &lt;- ggplot(iris,aes(Sepal.Length,Petal.Length)) +    # size is same across the board
  geom_point(size=2) 
plot_grid(plot1,plot2,plot3,plot4,plot5,plot6,ncol=2)</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Here is a graphic illustrating the main plot symbols you can
reference using <code>shape=</code>:</p>
<p><img src="points.png" /> Colors are a bit more intuitive, but here’s
a <a href="http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf">link
to a chart of R colors</a>)</p>
</div>
<div id="themes" class="section level3">
<h3>Themes</h3>
<p>You can see that the default plot includes a gray background with
white gridlines. This makes all of the elements on this plot easy to
see, but as you start adjusting colors and identifying your personal
preferences, you’ll probably want to customize this – ggplot has a ton
of options for doing so. Here’s a few examples of ggplot
<strong>themes</strong>:</p>
<pre class="r"><code># explore themes 

plot1 &lt;- ggplot(iris,aes(Sepal.Length,Petal.Length)) +    # color represents species
  geom_point(aes(color=Species)) +
  theme_bw()
plot2 &lt;- ggplot(iris,aes(Sepal.Length,Petal.Length)) +    # color represents species
  geom_point(aes(color=Species)) +
  theme_classic()
plot3 &lt;- ggplot(iris,aes(Sepal.Length,Petal.Length)) +    # color represents species
  geom_point(aes(color=Species)) +
  theme_minimal()
plot4 &lt;- ggplot(iris,aes(Sepal.Length,Petal.Length)) +    # color represents species
  geom_point(aes(color=Species)) +
  theme_minimal_grid(font_size = 11)

plot_grid(plot1,plot2,plot3,plot4,labels = &quot;AUTO&quot;)</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre class="r"><code># note: many other themes are available in ggplot, cowplot and other related packages</code></pre>
</div>
<div id="changing-title-and-axis-labels" class="section level3">
<h3>Changing title and axis labels</h3>
<p>We can also add titles, axis labels, and other options to make the
plots look prettier.</p>
<pre class="r"><code># add additional plot elements: title, axis limis, axis labels 

plot1 &lt;- ggplot(iris,aes(Sepal.Length,Petal.Length)) +    # color represents species
  geom_point(aes(color=Species)) + 
  labs(x=&quot;Sepal Length (cm)&quot;)

plot2 &lt;- ggplot(iris,aes(Sepal.Length,Petal.Length)) +    # color represents species
  geom_point(aes(color=Species)) + 
  labs(x=&quot;Sepal Length (cm)&quot;,y=&quot;Petal Length (cm)&quot;,color=&quot;Iris sp.&quot;)

plot3 &lt;- ggplot(iris,aes(Sepal.Length,Petal.Length)) +    # color represents species
  geom_point(aes(color=Species)) + 
  labs(x=&quot;Sepal Length (cm)&quot;,y=&quot;Petal Length (cm)&quot;,color=&quot;Iris sp.&quot;,
       title=&quot;Fisher&#39;s Iris Data&quot;,subtitle = &quot;practice with ggplot&quot;)

plot4 &lt;- ggplot(iris,aes(Sepal.Length,Petal.Length)) +    # color represents species
  geom_point(aes(color=Species)) + 
  coord_cartesian(xlim=c(0,10),ylim=c(0,10)) +
  labs(x=&quot;Sepal Length (cm)&quot;,y=&quot;Petal Length (cm)&quot;,color=&quot;Iris sp.&quot;,
       title=&quot;Fisher&#39;s Iris Data&quot;,subtitle = &quot;practice with ggplot&quot;)

plot_grid(plot1,plot2,plot3,plot4,labels = &quot;AUTO&quot;)</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
</div>
<div id="bar-plots-and-box-whisker-plots" class="section level2">
<h2>Bar Plots and box-whisker plots</h2>
<pre class="r"><code># bar plots, box-whisker plots, violin plots  -----------------------

plot1 &lt;- ggplot(iris,aes(x=Species,y=Sepal.Length)) +    # more informative box-whisker plot
  geom_boxplot() 
  
plot2 &lt;- ggplot(iris,aes(x=Species,y=Sepal.Length)) +    # more informative box-whisker plot +
  geom_violin() 

# bar plot
bar.heights &lt;- iris %&gt;% 
  group_by(Species) %&gt;% 
  summarize(meanSL = mean(Sepal.Length))

plot3 &lt;- ggplot(bar.heights, aes(Species,meanSL)) +
  geom_col()


plot4 &lt;- ggplot(bar.heights, aes(Species,meanSL)) +
  geom_col(aes(fill=Species)) +
  theme_classic() +
  scale_fill_manual(values=c(&quot;gray&quot;,&quot;red&quot;,&quot;brown&quot;))
  
plot_grid(plot1,plot2,plot3,plot4,labels = &quot;AUTO&quot;)</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>But what if we want to have some error bars?</p>
<pre class="r"><code># Bar plot with error bars

bar.heights &lt;- iris %&gt;% 
  group_by(Species) %&gt;% 
  summarize(meanSL = mean(Sepal.Length),
            n = n(),
            sdSL = sd(Sepal.Length),
            se = sdSL/sqrt(n))
  
ggplot(bar.heights,aes(x=Species,y=meanSL)) + 
  geom_col(fill=gray(0.7),color=&quot;black&quot;) +
  geom_errorbar(aes(ymin=meanSL-2*sdSL,ymax=meanSL+2*sdSL),width=.2) +
  labs(y=&quot;Sepal Length&quot;)</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>And for a slightly more complex example, let’s consider the built in
<code>ToothGrowth</code> data set, which looks at tooth growth in guinea
pigs under three different vitamin C doses and two different delivery
methods (orange juice or ascorbic acid).</p>
<pre class="r"><code># ?ToothGrowth
head(ToothGrowth)</code></pre>
<pre><code>##    len supp dose
## 1  4.2   VC  0.5
## 2 11.5   VC  0.5
## 3  7.3   VC  0.5
## 4  5.8   VC  0.5
## 5  6.4   VC  0.5
## 6 10.0   VC  0.5</code></pre>
<pre class="r"><code># toothgrowth plot 


ToothGrowth$dose &lt;- as.factor(ToothGrowth$dose)

sumTC &lt;- ToothGrowth %&gt;% 
  group_by(supp,dose) %&gt;% 
  summarize(mean = mean(len),
            sd = sd(len))


p&lt;- ggplot(sumTC, aes(x=dose, y=mean, fill=supp)) + 
  geom_col(color=&quot;black&quot;, 
           position=position_dodge()) +
  geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2,
                 position=position_dodge(0.9)) +
  labs(title=&quot;Tooth growth&quot;, x=&quot;Dose (mg)&quot;, y = &quot;Length&quot;) +
   theme_classic() +
   scale_fill_manual(values=c(&#39;#999999&#39;,&#39;#E69F00&#39;))

print(p)</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="practice-demo-with-some-new-stuff" class="section level2">
<h2>Practice demo (with some new stuff)</h2>
<p>For additional practice, let’s use the Soils dataset from the
‘carData’ package, which contains soil attributes from a gilgai
landscape (mounds and depressions caused by shrinking and swelling of
clays during dry and wet seasons) in Australia.</p>
<p>First we will need to load a few more packages. Make sure to install
any packages in this list you don’t already have!</p>
<pre class="r"><code># More complex demo -----------------------------

library(ggthemes)
library(carData)
library(DAAG)
library(RColorBrewer)</code></pre>
<p>Now load the dataset.</p>
<pre class="r"><code># Load the example data 

soil &lt;- carData::Soils    # load example data

#See what variables it contains...
head(soil)    # plot out the first few lines...</code></pre>
<pre><code>##   Group Contour Depth Gp Block   pH     N Dens   P    Ca   Mg    K   Na Conduc
## 1     1     Top  0-10 T0     1 5.40 0.188 0.92 215 16.35 7.65 0.72 1.14   1.09
## 2     1     Top  0-10 T0     2 5.65 0.165 1.04 208 12.25 5.15 0.71 0.94   1.35
## 3     1     Top  0-10 T0     3 5.14 0.260 0.95 300 13.02 5.68 0.68 0.60   1.41
## 4     1     Top  0-10 T0     4 5.14 0.169 1.10 248 11.92 7.88 1.09 1.01   1.64
## 5     2     Top 10-30 T1     1 5.14 0.164 1.12 174 14.17 8.12 0.70 2.17   1.85
## 6     2     Top 10-30 T1     2 5.10 0.094 1.22 129  8.55 6.92 0.81 2.67   3.18</code></pre>
<p>Staring simply, let’s say we’re interested in how pH, a continuous
variable, varies with contour position, a categorical factor:</p>
<pre class="r"><code># basic boxplot and violin plot

plot1 &lt;- ggplot(soil) +
  geom_boxplot(aes(x=Contour, y=pH))

plot2 &lt;- ggplot(soil) + 
  geom_violin(aes(x=Contour, y=pH))

plot_grid(plot1,plot2,labels = &quot;AUTO&quot;)</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>Next let’s try a simple scatterplot of two continuous variables,
Calcium content and pH:</p>
<pre class="r"><code># basic scatterplot

ggplot(soil) +
  geom_point(aes(x=pH, y=Ca))</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>Now let’s say you wanted to examine if/how the relationship between
pH and Ca varies with depth. You could go back to your scatterplot and
use color to identify points from the different sampling depths.</p>
<pre class="r"><code># Color the points by depth

ggplot(soil) +
  geom_point(aes(x=pH, y=Ca, color=Depth))</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>Try playing around with applying a few graphical attributes to all
the points (specified outside the <code>aes()</code> argument). Try
specifying <code>shape=21</code>, <code>color="black"</code> ,
<code>size=3</code> and <code>stroke=1</code>:</p>
<pre class="r"><code># make additional alterations (outside the &quot;aes&quot; function)

ggplot(soil) +
  geom_point(aes(x=pH, y=Ca, fill=Depth), shape=21, color=&quot;black&quot;, size=4, stroke=1.5)</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>Now for something new: let’s plot relationships between pH and
several soil nutrients on the same graph. Notice that the y axis label
defaults to the first set of points (Ca), and we’d need to modify it.
Also there is no legend! You’d have to change things like axis labels
and legend titles ‘manually’ to complete this figure.</p>
<pre class="r"><code># Plot several relationships on same plot

ggplot(soil, aes(x=pH)) +
  geom_point(aes(y=Ca), shape=21, fill=&quot;red&quot;, color=&quot;black&quot;, size=4, stroke=1.5) +
  geom_point(aes(y=Mg), shape=21, fill=&quot;blue&quot;, color=&quot;black&quot;, size=4, stroke=1.5) +
  geom_point(aes(y=Na), shape=21, fill=&quot;gray30&quot;, color=&quot;black&quot;, size=4, stroke=1.5)</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>There’s a better way to do it. But first we need to ‘reshape’ our
soils data with the tidyverse function `pivot_longer().</p>
<div id="aside-tidy-data-and-reshaping-functions"
class="section level3">
<h3>ASIDE: tidy data and reshaping functions</h3>
<p>All of the tidyverse set of packages are designed to work with
<em>Tidy</em> formatted data.</p>
<p>This means:</p>
<ul>
<li>Each variable must have its own column.</li>
<li>Each observation must have its own row.</li>
<li>Each value must have its own cell.</li>
</ul>
<p>This is what it looks like:</p>
<p><img src="tidy-1.png" /></p>
<p>The <em>tidyr</em> package has several functions to help you get your
data into this format.</p>
<p>Use “pivot_longer()” to get all of the values and variables from
multiple columns into a single column.</p>
<p><img src="tidy-9.png" /></p>
<p>Use “pivot_wider()” to distribute two variables in a single column
into separate columns, with their data values(‘value’)</p>
<p><img src="tidy-8.png" /></p>
<p>For a nice intro to ‘pivot_wider’ and ‘pivot_longer’, see <a
href="https://tidyr.tidyverse.org/articles/pivot.html">this link</a></p>
</div>
<div id="back-to-the-example" class="section level3">
<h3>Back to the example…</h3>
<p>Let’s reshape the soil dataset into the long format- which in this
case treats each separate nutrient measurement as a different
observation (row).</p>
<pre class="r"><code># Use &#39;tidyverse&#39; to reshape the data 

soil.nut &lt;- pivot_longer(soil, cols=c(&quot;Ca&quot;,&quot;Mg&quot;,&quot;Na&quot;), names_to=&quot;nutrient&quot;,values_to = &quot;value&quot; )
soil.nut</code></pre>
<pre><code>## # A tibble: 144 × 13
##    Group Contour Depth Gp    Block    pH     N  Dens     P     K Conduc nutrient
##    &lt;fct&gt; &lt;fct&gt;   &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;   
##  1 1     Top     0-10  T0    1      5.4  0.188  0.92   215  0.72   1.09 Ca      
##  2 1     Top     0-10  T0    1      5.4  0.188  0.92   215  0.72   1.09 Mg      
##  3 1     Top     0-10  T0    1      5.4  0.188  0.92   215  0.72   1.09 Na      
##  4 1     Top     0-10  T0    2      5.65 0.165  1.04   208  0.71   1.35 Ca      
##  5 1     Top     0-10  T0    2      5.65 0.165  1.04   208  0.71   1.35 Mg      
##  6 1     Top     0-10  T0    2      5.65 0.165  1.04   208  0.71   1.35 Na      
##  7 1     Top     0-10  T0    3      5.14 0.26   0.95   300  0.68   1.41 Ca      
##  8 1     Top     0-10  T0    3      5.14 0.26   0.95   300  0.68   1.41 Mg      
##  9 1     Top     0-10  T0    3      5.14 0.26   0.95   300  0.68   1.41 Na      
## 10 1     Top     0-10  T0    4      5.14 0.169  1.1    248  1.09   1.64 Ca      
## # … with 134 more rows, and 1 more variable: value &lt;dbl&gt;</code></pre>
<p>This lets us plot our different nutrients as factor levels without
typing each one with its specifications on its own line, and
automatically generates a legend that identifies the series (and also
gives the default ggplot colors).</p>
<pre class="r"><code>ggplot(soil.nut) +
  geom_point(aes(x=pH, y=value, fill=nutrient), shape=21, color=&quot;black&quot;, size=4, stroke=1.5)</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>What if instead of Na, we had K as our third nutrient of
interest?</p>
<pre class="r"><code># or if we wanted to plot different nutrients...

soil.nut2 &lt;- pivot_longer(soil, cols=c(&quot;Ca&quot;,&quot;Mg&quot;,&quot;K&quot;), names_to=&quot;nutrient&quot;,values_to = &quot;value&quot; )

ggplot(soil.nut2) +
  geom_point(aes(x=pH, y=value, fill=nutrient), shape=21, color=&quot;black&quot;, size=4, stroke=1.5)</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>The problem here is that K occurs at natural concentrations that
differ from the other nutrients by an order of magnitude, so it’s
difficult to examine them all on the same scale. One approach we can
take is to plot them separately. While we’re at it, let’s also make sure
that we specify the response units on the y-axis.</p>
</div>
<div id="facets-and-scales-and-themes" class="section level3">
<h3>Facets and scales, and themes</h3>
<p>The next plot introduces:</p>
<ul>
<li><p><strong>facets</strong>, which allow you to display data on
separate panels using some grouping variable</p></li>
<li><p><strong>scales</strong>, which allow you to adjust how to
represent the data with axes and colors</p></li>
</ul>
<p>We also play around with some more ggplot <em>themes</em>.</p>
<pre class="r"><code># plot with facets, scales, and themes!

ggplot(soil.nut2) +
  geom_point(aes(x=pH, y=value, fill=nutrient), 
             shape=21, color=&quot;black&quot;, size=4, stroke=1.5) +
  facet_wrap(~nutrient, scales=&quot;free_y&quot;) +
  labs(y=&quot;mg / 100 g soil&quot;) +
  theme_bw() +
  theme(legend.position=&quot;none&quot;,
        axis.text = element_text(size=20),
        axis.title = element_text(size=25),
        strip.text = element_text(size=25, face=&quot;bold&quot;))</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-22-1.png" width="768" /></p>
<p>In this plot, we’ve kept the different colors for each nutrient, but
suppressed the legend that is auto-generated by ggplot, because this
information is now redundant with the headers of the three facets. In
the <strong><code>facet_wrap</code></strong> function, we used
<strong><code>scales</code></strong> to specify that the y-axis should
be bounded to fit the data within each facet. There are some cases where
you would probably want the axes to be the same – e.g. if you were
comparing raw values across groups, rather than the distributions or
trends of the data.</p>
<p>We also changed the theme. ggplot has <a
href="http://r4ds.had.co.nz/images/visualization-themes.png">8 built-in
themes</a> to choose from. There are also lots of other themes built
into extension packages such as ggthemes.</p>
<p>You can also fine-tune pretty much any of the details (gridlines or
no? plot borders? line weight of the borders and gridlines? axis label
angles?) to your heart’s content using the arguments in the
<strong><code>theme()</code></strong> function.</p>
</div>
<div id="aside-specifying-colors" class="section level3">
<h3>ASIDE: Specifying colors</h3>
<p>Sometimes sticking to the default colors in ggplot isn’t the best
choice. You might have factors representing ordered ranks, like in an
experiment with different levels of light exposure, and want to
represent these levels on a monochromatic scale. Or you might want to
make a map displaying regions of positive or negative change in forest
cover, using a diverging color scale. Or you don’t even like the default
ggplot colors, and have your own preferred color schemes. It’s also
important to remember that red-green colorblindness is fairly common, so
if you are presenting data that must be distinguished by colors in a
single plotting area, you should probably avoid this combination or
combine it with changes in value (light to dark) in order for your plot
to be accessible.</p>
<p>Going back to our earlier example showing Ca content by pH at
different depths, let’s say we want a color scheme where deeper depths
are represented by darker values of the same color. We can do this by
using another scale function.</p>
<p>One method is to use <strong><code>scale_fill_brewer</code></strong>,
and select an already composed color palette from RColorBrewer (a
package you’ll need to install). You can check out all of the options
available in RColorBrewer by entering
<strong><code>display.brewer.all()</code></strong>, which shows the
sequential palettes, then categorical palettes, than diverging
palettes.</p>
<pre class="r"><code># Playing with colors in ggplot!

display.brewer.all()</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-23-1.png" width="576" /></p>
<p>I’m going to pick the YlOrBr (Yellow-Orange-Brown) palette, because
those seem like good soil-y colors. Notice that because
<strong><code>fill</code></strong> is mapped to the values of the data,
inside this function is where I can change the title of the legend (and
the labels for the different values, if I wanted to do that).</p>
<pre class="r"><code># Choose a new color palette from the RColorBrewer package

ggplot(soil) +
  geom_point(aes(x=pH, y=Ca, fill=Depth), shape=21, color=&quot;black&quot;, size=4, stroke=1.5) +
  theme_classic() +
  labs(y=&quot;Ca (mg/100g soil)&quot;) +
  scale_fill_brewer(palette=&quot;YlOrBr&quot;, name=&quot;Depth (cm)&quot;)</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>Another method is to use
<strong><code>scale_fill_manual</code></strong>, with which you define
your own palette. To pick out your colors, you can use the <a
href="&#39;http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf">names
of colors</a> already recognized by R, or use <a
href="https://htmlcolorcodes.com/">hex codes</a> for any color you
want.</p>
<pre class="r"><code># Choose your own palette!

ggplot(soil) +
  geom_point(aes(x=pH, y=Ca, fill=Depth), shape=21, color=&quot;black&quot;, size=4, stroke=1.5) +
  theme_bw() +
  ylab(&quot;Ca (mg/100g soil)&quot;) +
  scale_fill_manual(values=c(&quot;#FFF0BF&quot;,&quot;#FFC300&quot;,&quot;#BF9200&quot;,&quot;#604900&quot;), name=&quot;Depth (cm)&quot;)</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>What if depth were a continuous variable, rather than a set of four
discrete categories? We could use
<strong><code>scale_fill_gradient</code></strong>, supply the hues we
want (one for monochromatic, two for diverging) and R would map the soil
depth values to color values along the gradient.</p>
<div id="trendlines" class="section level4">
<h4>Trendlines</h4>
<p>Next, we might want to add a trendline to each set of points. Try it
for the plot we made of different nutrient concentrations as a function
of pH. Arguments in the <strong><code>geom_smooth()</code></strong>
function allow us to change the confidence level, the smoothing method,
and other details:</p>
<pre class="r"><code># add trendlines

ggplot(soil.nut2) +
  geom_point(aes(x=pH, y=value, fill=nutrient), 
             shape=21, color=&quot;black&quot;, size=4, stroke=1.5) +
  geom_smooth(aes(x=pH, y=value), method=&quot;lm&quot;, color=&quot;black&quot;) +
  facet_wrap(~nutrient, scales=&quot;free_y&quot;) +
  ylab(&quot;mg / 100 g soil&quot;) +
  theme_classic() +
  theme(legend.position=&quot;none&quot;,
        axis.text = element_text(size=14),
        axis.title = element_text(size=16),
        strip.text = element_text(size=16, face=&quot;bold&quot;))</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-26-1.png" width="768" /></p>
</div>
</div>
<div id="density-curves-and-error-bars" class="section level3">
<h3>Density curves and error bars</h3>
<p>Using <strong><code>geom_smooth</code></strong> to plot trendlines is
a useful way to get more information from your scatterplots. To get an
idea for how other kinds of statistical elements can be drawn onto
plots, we’ll look at examples using histograms and boxplots.</p>
<p>First, a simple histogram of 3 soil nutrients.</p>
<pre class="r"><code># Adding density/smooth curves to plots

   ## first produce some histograms

ggplot(soil.nut) +
  geom_histogram(aes(x=value), color=&quot;black&quot;, fill=&quot;white&quot;, bins=15) +
  facet_wrap(~nutrient, scales=&quot;free&quot;) +
  xlab(&quot;mg / 100g soil&quot;) +
  theme_classic() +
  theme(axis.text = element_text(size=20),
        axis.title = element_text(size=25),
        strip.text = element_text(size=25, face=&quot;bold&quot;))</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-27-1.png" width="768" /></p>
<p>Here is how to add a density curve to the histogram with another
<strong><code>geom</code></strong>:</p>
<pre class="r"><code># Then add density curves

ggplot(soil.nut) +
  geom_histogram(aes(x=value, y=..density..), color=&quot;black&quot;, fill=&quot;white&quot;, bins=15) +
  geom_density(aes(x=value,color=nutrient), size=1.5) +
  facet_wrap(~nutrient, scales=&quot;free&quot;) +
  xlab(&quot;mg / 100g soil&quot;) +
  theme_classic() +
  theme(legend.position=&quot;none&quot;,
        axis.text = element_text(size=20),
        axis.title = element_text(size=25),
        strip.text = element_text(size=25, face=&quot;bold&quot;))</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-28-1.png" width="768" /></p>
<p>And here’s how we can compare our distributions to a normal
distribution, using a <strong><code>stat</code></strong> function:</p>
<pre class="r"><code># And now let&#39;s use a statistical function (dnorm) in ggplot to compare with a normal distribution:

ggplot(soil.nut) +
  geom_histogram(aes(x=value, y=..density..), color=&quot;black&quot;, fill=&quot;white&quot;, bins=15) +
  stat_function(fun = dnorm, color = &quot;blue&quot;, size = 1.5,
                args=list(mean=mean(soil.nut$value), sd=sd(soil.nut$value))) +
  facet_wrap(~nutrient, scales=&quot;free&quot;) +
  xlab(&quot;mg / 100g soil&quot;) +
  theme_classic() +
  theme(legend.position=&quot;none&quot;,
        axis.text = element_text(size=20),
        axis.title = element_text(size=25),
        strip.text = element_text(size=25, face=&quot;bold&quot;))</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-29-1.png" width="768" /></p>
<p>Let’s go back to our basic boxplot, the default plot for visualizing
continuous data against categories.</p>
<p>First, you may have noticed that the whiskers do not have caps on
them, as they do in base R. This is a matter of personal preference, but
if capless whiskers look “off” to you, then you can work around it using
<strong><code>stat_boxplot</code></strong>.
<strong><code>stat_</code></strong> functions are another group of
functions for creating layers based on statistical properties of the
data. Another example is <strong><code>stat_summary</code></strong>,
which we use in the example below to add means to the boxplot.</p>
<pre class="r"><code># add error bars and other stat summaries (e.g., mean) to boxplot

ggplot(soil, aes(x=Contour, y=pH)) +
  stat_boxplot(geom=&quot;errorbar&quot;, width=0.2) +  
  stat_boxplot() +
  stat_summary(fun=mean,geom=&quot;point&quot;,size=5, color=&quot;black&quot;)</code></pre>
<p><img src="module1_3_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<p>Interestingly, there is generally a way to add just about any
graphical element using either “stat_” or “geom_” functions. It’s a good
idea to play around with both!</p>
</div>
</div>
<div id="beyond-ggplot" class="section level2">
<h2>Beyond ggplot</h2>
<p>ggplot contains an incredibly rich and powerful set of tools for
visualizing data. But ggplot and base R are not your only options! A
variety of packages exist for visualization, including:</p>
<div id="ggplot-extensions" class="section level3">
<h3>ggplot extensions</h3>
<p>Several packages have been created that build off of ggplot’s syntax
with additional functions. You can find a list of them <a
href="https://exts.ggplot2.tidyverse.org/gallery/">here</a>.</p>
</div>
<div id="technique-specific-plotting-libraries" class="section level3">
<h3>Technique-specific plotting libraries</h3>
<p>Several analytical packages come with their own plotting functions
that produce some very nice visualizations. There are dozens out there,
but a few of them are <a
href="https://cran.r-project.org/web/packages/visreg/visreg.pdf">visreg</a>
for regression plots, <a
href="https://cran.r-project.org/web/packages/corrplot/index.html">corrplot</a>
(and its ggplot counterpart, <a
href="http://www.sthda.com/english/wiki/ggcorrplot-visualization-of-a-correlation-matrix-using-ggplot2">ggcorrplot</a>)
for graphical presentation of correlation matrices, and <a
href="https://cran.r-project.org/web/packages/rpart.plot/index.html">rpart.plot</a>
as a companion to the decision tree package rpart.</p>
<div id="interactive-plots-leaflet-and-plotly" class="section level5">
<h5>Interactive plots: leaflet and plotly</h5>
<p>Increasingly, scientific journals are providing platforms for
interactive graphics on their websites to accompany published articles.
Interactive plots are also popular for personal, lab, and organizational
websites, and they can provide another option for your own data
exploration. Two of the most popular in R are <a
href="https://plot.ly/r/">plotly</a>, which offers a huge variety of 2D
and 3D plots, and <a
href="https://rstudio.github.io/leaflet/">leaflet</a>, which is
specifically for mapping.</p>
<p>Here’s a quick and simple example of leaflet in action using the
“possumsites” dataframe that accompanies the “possum” dataset in the
DAAG package. The dataset contains body measurements of several possums
in Australia. Where did they catch these possums?</p>
<pre class="r"><code># use leaflet for interactive mapping! ------------

leaflet(possumsites) %&gt;%
  addTiles() %&gt;% #Adds map tiles from OpenStreetMap
  addMarkers(lng=c(possumsites$Longitude), lat=c(possumsites$Latitude), 
             popup=c(as.character(possumsites$altitude))) #Adds markers for the sites</code></pre>
</div>
</div>
</div>
<div id="challenge-exercises" class="section level2">
<h2>Challenge exercises</h2>
<ol style="list-style-type: decimal">
<li>Using our scatterplot of calcium by pH, in which points were colored
according to which depth they represent, visualize a separate trendline
for each depth category. Have the color of the trendline match the color
of each cloud of points. Remove the confidence band from the trendlines.
The plot should look something like this:</li>
</ol>
<p><img src="module1_3_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<ol start="2" style="list-style-type: decimal">
<li>Create a boxplot that shows the values of Ca, Mg, and Na across all
3 contour positions, with no faceting (all on one plot). Add a diamond
symbol indicating the mean value across all 3 contour positions for each
nutrient. The plot should look something like this:</li>
</ol>
<p><img src="module1_3_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<ol start="3" style="list-style-type: decimal">
<li>Plot the density curves of Ca, Mg, and Na atop each other with fixed
y and x axes. Make them transparent in color (use
<code>alpha=0.5</code>) in order to see overlapping areas. The plot
should look like this (uses <code>theme_dark()</code>):</li>
</ol>
<p><img src="module1_3_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<pre class="r"><code># CHALLENGE EXERCISES   -------------------------------------

# 1. Using our scatterplot of calcium by pH, in which points were colored according to which depth they represent, 
#     fit a separate trendline for each depth category. Have the color of the trendline match the color of each 
#     cloud of points. Remove the confidence band from the trendlines. 
#
# 2. Create a boxplot that shows the values of Ca, Mg, and Na across all 3 contour positions, with no faceting (all on one plot). 
#     Add a diamond symbol indicating the mean value across all 3 contour positions for each nutrient.
#
# 3. Plot the density curves of Ca, Mg, and Na atop each other with fixed y and x axes. Make them transparent in color 
#     (use `alpha=0.5`) in order to see overlapping areas.</code></pre>
<p><a href="module1_4.html">–go to next submodule–</a></p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
