<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Basic programming in R" />


<title>Module 1.4</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/journal.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 61px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h2 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h3 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h4 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h5 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h6 {
  padding-top: 66px;
  margin-top: -66px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R bootcamp, Fall 2020</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Bootcamp #1: getting started
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="module1_1.html">Submodule 1.1: working with objects</a>
    </li>
    <li>
      <a href="module1_2.html">Submodule 1.2: managing data</a>
    </li>
    <li>
      <a href="module1_3.html">Submodule 1.3: plotting and basic stats</a>
    </li>
    <li>
      <a href="module1_4.html">Submodule 1.4: Programming in R</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Bootcamp #2: Beyond the basics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="module2_1.html">Submodule 2.1: R packages</a>
    </li>
    <li>
      <a href="module2_2.html">Submodule 2.2: Using the 'tidyverse'</a>
    </li>
    <li>
      <a href="module2_3.html">Submodule 2.3: Plotting with 'ggplot'</a>
    </li>
    <li>
      <a href="module2_4.html">Submodule 2.4: Parallel computing in R</a>
    </li>
    <li>
      <a href="module2_5.html">Submodule 2.5: Spatial analysis</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Data sets
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="data.dat">Example: tab-separated data</a>
    </li>
    <li>
      <a href="data.csv">Example: comma-separated data</a>
    </li>
    <li>
      <a href="data.txt">Example: whitespace-separated data</a>
    </li>
    <li>
      <a href="data_missing.txt">Example: missing data</a>
    </li>
    <li>
      <a href="MTMetStations.csv">Meteorological Data</a>
    </li>
    <li>
      <a href="sculpineggs.csv">Sculpin Data</a>
    </li>
    <li>
      <a href="turtle_data.txt">Turtle Data</a>
    </li>
    <li>
      <a href="geneData.csv">Gene Data</a>
    </li>
    <li>
      <a href="reptiles.csv">Reptile Data</a>
    </li>
    <li>
      <a href="data.zip">GIS Data</a>
    </li>
  </ul>
</li>
<li>
  <a href="Links.html">Links</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Module 1.4</h1>
<h4 class="author">Basic programming in R</h4>
<h4 class="date">Fall 2020</h4>

</div>


<p>NOTE: this module borrows heavily from an R short course developed by a team at Colorado State University.</p>
<div id="load-script-for-module-1.4" class="section level2">
<h2>Load script for module #1.4</h2>
<ol style="list-style-type: decimal">
<li><p>Click <a href="module1_4.R">here</a> to download the script! Save the script to your working directory (R Project directory).</p></li>
<li><p>Load your script in your RStudio Project. To do this, open your RStudio Project and click on the folder icon in the toolbar at the top and load your script.</p></li>
</ol>
<p>Let’s get started with basic programming in R!</p>
</div>
<div id="functions-in-r" class="section level2">
<h2>Functions in R</h2>
<p>Everything in R can be boiled down to this one sentence: data are expressed as <em>vectors</em>, and data objects are managed, manipulated, and visualized via <strong>functions</strong>. Functions are absolutely central to R!</p>
<p>Let’s start with a blank workspace:</p>
<pre class="r"><code>#######
# Start with blank workspace

rm(list=ls())</code></pre>
<p>As we have seen, base R already includes lots of functions, and thousands more functions are available in packages that you can install (next module of this workshop). Nonetheless, it’s really useful to know how to write your own functions! For example, we might write our own function if we have to repeat certain sets of operations over and over in different contexts.</p>
<p>We use the following syntax when we are writing our own functions:</p>
<pre><code>
my.function &lt;- function(input1,input2,...){         # function takes various arguments (inputs)
    
    ## [Algorithm goes here: Do something useful with the inputs]
    
    return(output)  # return some output
}
</code></pre>
<div id="first-function-hello-world" class="section level3">
<h3>First function: “Hello, world!”</h3>
<p>Let’s try to write our first function, which prints out a message: “Hello, world!”</p>
<pre class="r"><code>####
####  Functions
####

my.function = function(){       # this function has no arguments
  message &lt;- &quot;Hello, world!&quot;
  return(message)
}</code></pre>
<p>Now we can run the function!</p>
<pre class="r"><code>my.function()</code></pre>
<pre><code>## [1] &quot;Hello, world!&quot;</code></pre>
<p>What happens if you run the function without the parentheses?</p>
<pre class="r"><code>my.function      # try running without parentheses-   what happens?</code></pre>
<pre><code>## function(){       # this function has no arguments
##   message &lt;- &quot;Hello, world!&quot;
##   return(message)
## }</code></pre>
</div>
<div id="mean-function" class="section level3">
<h3>‘Mean’ function</h3>
<p>Let’s write a function to compute the mean of a vector. Okay fine, base R already has the “mean()” function, but let’s do it anyway!</p>
<pre class="r"><code>## We can write our own functions. Useful if we have to repeat the same operations over and over with different inputs.
my.mean &lt;- function(x){
    m &lt;- sum(x)/length(x)
    return(m)
}

foo &lt;- c(2, 4, 6, 8)
my.mean(foo)</code></pre>
<pre><code>## [1] 5</code></pre>
</div>
<div id="square-function" class="section level3">
<h3>‘Square’ function</h3>
<p>How about a function to square its arguments?</p>
<pre class="r"><code>## A function to square the arguments.
square &lt;- function(x){
    x^2
}

## Square a single value (scalar).
square(2)</code></pre>
<pre><code>## [1] 4</code></pre>
<pre class="r"><code>## Square all elements of a vector.
square(1:10)</code></pre>
<pre><code>##  [1]   1   4   9  16  25  36  49  64  81 100</code></pre>
</div>
<div id="logit-function" class="section level3">
<h3>‘Logit’ function</h3>
<p>The logit operation (log-odds) is not included in the base R package. Let’s write it ourselves!</p>
<pre class="r"><code>## Often, we need to write functions that are not included in the base R package e.g., the logit function.
## Calculate the log-odds (logit).
logit &lt;- function(x){
    log(x/(1-x))
}

## Calculate logit of 0.9.
logit(.9)</code></pre>
<pre><code>## [1] 2.197225</code></pre>
<pre class="r"><code>## Sequence between 0 and 1.
x &lt;- seq(from = 0, to = 1, by = 0.01)

## Caclulate the logit of a vector.
logit.x &lt;- logit(x)
logit.x</code></pre>
<pre><code>##   [1]        -Inf -4.59511985 -3.89182030 -3.47609869 -3.17805383
##   [6] -2.94443898 -2.75153531 -2.58668934 -2.44234704 -2.31363493
##  [11] -2.19722458 -2.09074110 -1.99243016 -1.90095876 -1.81528997
##  [16] -1.73460106 -1.65822808 -1.58562726 -1.51634749 -1.45001018
##  [21] -1.38629436 -1.32492541 -1.26566637 -1.20831121 -1.15267951
##  [26] -1.09861229 -1.04596856 -0.99462258 -0.94446161 -0.89538405
##  [31] -0.84729786 -0.80011930 -0.75377180 -0.70818506 -0.66329422
##  [36] -0.61903921 -0.57536414 -0.53221681 -0.48954823 -0.44731222
##  [41] -0.40546511 -0.36396538 -0.32277339 -0.28185115 -0.24116206
##  [46] -0.20067070 -0.16034265 -0.12014431 -0.08004271 -0.04000533
##  [51]  0.00000000  0.04000533  0.08004271  0.12014431  0.16034265
##  [56]  0.20067070  0.24116206  0.28185115  0.32277339  0.36396538
##  [61]  0.40546511  0.44731222  0.48954823  0.53221681  0.57536414
##  [66]  0.61903921  0.66329422  0.70818506  0.75377180  0.80011930
##  [71]  0.84729786  0.89538405  0.94446161  0.99462258  1.04596856
##  [76]  1.09861229  1.15267951  1.20831121  1.26566637  1.32492541
##  [81]  1.38629436  1.45001018  1.51634749  1.58562726  1.65822808
##  [86]  1.73460106  1.81528997  1.90095876  1.99243016  2.09074110
##  [91]  2.19722458  2.31363493  2.44234704  2.58668934  2.75153531
##  [96]  2.94443898  3.17805383  3.47609869  3.89182030  4.59511985
## [101]         Inf</code></pre>
<pre class="r"><code>## Plot x on x-axis, and logit(x) on y axis.
plot(x, logit.x, type = &#39;l&#39;,xlab=&quot;x&quot;,ylab=&quot;logit(x)&quot;)    # View the output graphically.</code></pre>
<p><img src="module1_4_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="expit-function" class="section level3">
<h3>‘Expit’ function</h3>
<p>A useful, related function is the inverse-logit, or “expit” function:</p>
<pre class="r"><code>## Sequence between 0 and 1.
x &lt;- seq(from = 0, to = 1, by = 0.01)

logit.x &lt;- logit(x)

## The expit (or inverse logit) funtion.
expit &lt;- function(x){
    exp(x)/(1+exp(x))
}

## Calculate the inverse-logit of logit(0.9) = 2.197225.
expit(2.197225)</code></pre>
<pre><code>## [1] 0.9</code></pre>
<pre class="r"><code>expit.logit.x &lt;- expit(logit.x)    # Return to original x values.

## Plot x on x-axis, and expit(logit(x)) = x on y axis.
plot(x, expit.logit.x, type = &#39;l&#39;,xlab=&quot;x&quot;,ylab=&quot;expit(logit(x))&quot;)</code></pre>
<p><img src="module1_4_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r"><code>## Plot &quot;logistic&quot; curve
plot(x=seq(-3,3,0.1),y=expit(seq(-3,3,0.1)),type=&quot;l&quot;,xlab=&quot;x&quot;,ylab=&quot;expit(x)&quot;)</code></pre>
<p><img src="module1_4_files/figure-html/unnamed-chunk-9-2.png" width="672" /></p>
</div>
<div id="wildlife-survival-function" class="section level3">
<h3>Wildlife survival function</h3>
<p>Finally, let’s develop a function to compute the survival rate from data collected on wild individuals tracked over time:</p>
<pre class="r"><code>## n is the number of animals being monitored.
## d is the number of animals that died.
survival &lt;- function(n, d){
    (n-d)/n
}

## One year of data.
survival(n = 10, d = 5)</code></pre>
<pre><code>## [1] 0.5</code></pre>
<pre class="r"><code>## Simulate many years of data.
d &lt;- sample(0:50, 10, replace = TRUE)   # note use of &quot;sample()&quot; function   [random number of dead individuals]
n &lt;- rep(100, times=10)                 # total number of individuals 
surv &lt;- survival(n = n, d = d)
surv</code></pre>
<pre><code>##  [1] 0.90 0.60 0.81 0.84 0.76 0.69 0.82 0.94 0.96 0.92</code></pre>
<pre class="r"><code>## Plot year-specific survival rate (random- will look different every time!)
plot(1:10, surv, type = &#39;l&#39;,xlab=&quot;Year&quot;,ylab=&quot;Survival&quot;)</code></pre>
<p><img src="module1_4_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
</div>
<div id="conditional-statements" class="section level2">
<h2>Conditional statements</h2>
<p>Conditional, or logical, operations (IF [condition] THEN [do something] ELSE [do something]) are a basic building block of computer programming.</p>
<div id="ifelse-statements-in-r" class="section level3">
<h3>if…else statements in R</h3>
<p>The basic syntax for if…else statements in R is as follows:</p>
<pre><code>
if([some condition]){               ## if some condition is met
  [execute some commands]
}else if ([some other condition]){   ## if some other condition is met (often this clause is not necessary)
  [execute some other commands]
}else{                               ## if none of the above conditions are met (otherwise...)
  [execute some other commands]
}
</code></pre>
<p>NOTE: you can include any number of “else if(…)” statements- or you can omit these entirely!</p>
<p>Let’s try it!</p>
<pre class="r"><code>####
####  if...else statements
####

########
# Draw a sample from a Binomial distribution with p = 0.7 (here, p is detection probability).
p &lt;- 0.7            # probability of detection
x &lt;- rbinom(n = 1, size = 1, prob = p)      # single &#39;coin flip&#39; with prob success equal to p

if (x &gt; 0) {
    print(&quot;Detected&quot;)
} else {
    print(&quot;Not detected&quot;)
}</code></pre>
<pre><code>## [1] &quot;Detected&quot;</code></pre>
<pre class="r"><code>######
# Make a &quot;safe&quot; version of the &quot;logit&quot; function

logit.safe &lt;- function(x){
    bad &lt;- ((x&lt;0)|(x&gt;1))
    if(any(bad)){
      stop(&quot;logit is only defined for x between 0 and 1!&quot;)
    }else{
      log(x/(1-x))
    }
    
}
x &lt;- seq(from = -1, to = 2, by = 0.1)
# logit(x)      # this returns impossible numbers (NaNs)
# logit.safe(x)   # this will throw an informative error!

logit.safe(c(0.15,0.99))</code></pre>
<pre><code>## [1] -1.734601  4.595120</code></pre>
</div>
<div id="ifelse-function" class="section level3">
<h3>ifelse() function</h3>
<p>Note that “if…else” only works for testing one condition at a time. If we have a spreadsheet with lots of data, we need something else – something “vectorized” – like the “ifelse()” function:</p>
<pre class="r"><code>####
####  ifelse()
####

## Note if...else only works for running one logical (T/F) test at a time. If we have a spreadsheet with lots of data, we need something else.
n.samples &lt;- 100
set.seed(2017)     # the &#39;seed&#39; allows random number generators to give the same result every time!

## 100 samples from a binomial distribution with detection probability p = 0.7.
y &lt;- rbinom(n = n.samples, size = 1, prob = p)
y</code></pre>
<pre><code>##   [1] 0 1 1 1 0 0 1 1 1 1 1 1 1 1 1 1 1 0 0 0 1 1 0 0 1 0 1 1 1 1 0 1 1 1 0 1 1
##  [38] 1 1 1 1 1 1 1 0 1 1 1 0 0 1 0 1 1 0 1 1 0 1 0 1 1 1 0 0 1 1 1 1 1 0 1 1 0
##  [75] 0 1 1 1 1 0 1 0 1 0 1 1 1 1 1 1 0 1 1 1 0 1 0 1 0 1</code></pre>
<pre class="r"><code>## incorrect usage
if (y == 1) {
    print(&quot;Detected&quot;)
} else {
    print(&quot;Not detected&quot;)
}   # PRINTS A WARNING MESSAGE!</code></pre>
<pre><code>## Warning in if (y == 1) {: the condition has length &gt; 1 and only the first
## element will be used</code></pre>
<pre><code>## [1] &quot;Not detected&quot;</code></pre>
<pre class="r"><code>## Use ifelse instead.
detection.history &lt;- ifelse(y == 1, print(&quot;Detected&quot;), print(&quot;Not detected&quot;))</code></pre>
<pre><code>## [1] &quot;Detected&quot;
## [1] &quot;Not detected&quot;</code></pre>
<pre class="r"><code>detection.history</code></pre>
<pre><code>##   [1] &quot;Not detected&quot; &quot;Detected&quot;     &quot;Detected&quot;     &quot;Detected&quot;     &quot;Not detected&quot;
##   [6] &quot;Not detected&quot; &quot;Detected&quot;     &quot;Detected&quot;     &quot;Detected&quot;     &quot;Detected&quot;    
##  [11] &quot;Detected&quot;     &quot;Detected&quot;     &quot;Detected&quot;     &quot;Detected&quot;     &quot;Detected&quot;    
##  [16] &quot;Detected&quot;     &quot;Detected&quot;     &quot;Not detected&quot; &quot;Not detected&quot; &quot;Not detected&quot;
##  [21] &quot;Detected&quot;     &quot;Detected&quot;     &quot;Not detected&quot; &quot;Not detected&quot; &quot;Detected&quot;    
##  [26] &quot;Not detected&quot; &quot;Detected&quot;     &quot;Detected&quot;     &quot;Detected&quot;     &quot;Detected&quot;    
##  [31] &quot;Not detected&quot; &quot;Detected&quot;     &quot;Detected&quot;     &quot;Detected&quot;     &quot;Not detected&quot;
##  [36] &quot;Detected&quot;     &quot;Detected&quot;     &quot;Detected&quot;     &quot;Detected&quot;     &quot;Detected&quot;    
##  [41] &quot;Detected&quot;     &quot;Detected&quot;     &quot;Detected&quot;     &quot;Detected&quot;     &quot;Not detected&quot;
##  [46] &quot;Detected&quot;     &quot;Detected&quot;     &quot;Detected&quot;     &quot;Not detected&quot; &quot;Not detected&quot;
##  [51] &quot;Detected&quot;     &quot;Not detected&quot; &quot;Detected&quot;     &quot;Detected&quot;     &quot;Not detected&quot;
##  [56] &quot;Detected&quot;     &quot;Detected&quot;     &quot;Not detected&quot; &quot;Detected&quot;     &quot;Not detected&quot;
##  [61] &quot;Detected&quot;     &quot;Detected&quot;     &quot;Detected&quot;     &quot;Not detected&quot; &quot;Not detected&quot;
##  [66] &quot;Detected&quot;     &quot;Detected&quot;     &quot;Detected&quot;     &quot;Detected&quot;     &quot;Detected&quot;    
##  [71] &quot;Not detected&quot; &quot;Detected&quot;     &quot;Detected&quot;     &quot;Not detected&quot; &quot;Not detected&quot;
##  [76] &quot;Detected&quot;     &quot;Detected&quot;     &quot;Detected&quot;     &quot;Detected&quot;     &quot;Not detected&quot;
##  [81] &quot;Detected&quot;     &quot;Not detected&quot; &quot;Detected&quot;     &quot;Not detected&quot; &quot;Detected&quot;    
##  [86] &quot;Detected&quot;     &quot;Detected&quot;     &quot;Detected&quot;     &quot;Detected&quot;     &quot;Detected&quot;    
##  [91] &quot;Not detected&quot; &quot;Detected&quot;     &quot;Detected&quot;     &quot;Detected&quot;     &quot;Not detected&quot;
##  [96] &quot;Detected&quot;     &quot;Not detected&quot; &quot;Detected&quot;     &quot;Not detected&quot; &quot;Detected&quot;</code></pre>
<pre class="r"><code>## Going the other direction.
ifelse(detection.history == &quot;Detected&quot;, 1, 0)</code></pre>
<pre><code>##   [1] 0 1 1 1 0 0 1 1 1 1 1 1 1 1 1 1 1 0 0 0 1 1 0 0 1 0 1 1 1 1 0 1 1 1 0 1 1
##  [38] 1 1 1 1 1 1 1 0 1 1 1 0 0 1 0 1 1 0 1 1 0 1 0 1 1 1 0 0 1 1 1 1 1 0 1 1 0
##  [75] 0 1 1 1 1 0 1 0 1 0 1 1 1 1 1 1 0 1 1 1 0 1 0 1 0 1</code></pre>
<pre class="r"><code>xt  &lt;-  cbind(rbinom(10, 1, .5), rbinom(10, 1, .6))
xt</code></pre>
<pre><code>##       [,1] [,2]
##  [1,]    1    1
##  [2,]    1    1
##  [3,]    0    0
##  [4,]    0    1
##  [5,]    1    0
##  [6,]    0    0
##  [7,]    0    1
##  [8,]    1    1
##  [9,]    0    1
## [10,]    0    1</code></pre>
<pre class="r"><code>ifelse(xt[, 1] &gt; 0 &amp; xt[, 2] &gt; 0, print(&quot;Detected twice&quot;),
       print(&quot;Not detected twice&quot;))</code></pre>
<pre><code>## [1] &quot;Detected twice&quot;
## [1] &quot;Not detected twice&quot;</code></pre>
<pre><code>##  [1] &quot;Detected twice&quot;     &quot;Detected twice&quot;     &quot;Not detected twice&quot;
##  [4] &quot;Not detected twice&quot; &quot;Not detected twice&quot; &quot;Not detected twice&quot;
##  [7] &quot;Not detected twice&quot; &quot;Detected twice&quot;     &quot;Not detected twice&quot;
## [10] &quot;Not detected twice&quot;</code></pre>
</div>
</div>
<div id="iterating" class="section level2">
<h2>Iterating!</h2>
<p>Iterating, or running the same operation over and over sequentially, is another fundamental computer programming tool. Computers are great at performing multiple computations really, really fast! <strong>Loops</strong> are a good way to take advantage of computers!</p>
<p>The basic syntax for iterating in R is called a “FOR loop”, and looks like this:</p>
<pre><code>
for([iteration variable] in [iteration vector of length x]){
  [perform specified operation(s) x times, with the iteration variable alternately set at each value of the iteration vector]
}
</code></pre>
<p>For example…</p>
<pre class="r"><code>####
####  for loops
####

for(i in 1:10){
  print(i)
}</code></pre>
<pre><code>## [1] 1
## [1] 2
## [1] 3
## [1] 4
## [1] 5
## [1] 6
## [1] 7
## [1] 8
## [1] 9
## [1] 10</code></pre>
<pre class="r"><code>for(j in c(1,2,3,4,5,6,7,8,9,10)){       # alternative
  print(j)
}</code></pre>
<pre><code>## [1] 1
## [1] 2
## [1] 3
## [1] 4
## [1] 5
## [1] 6
## [1] 7
## [1] 8
## [1] 9
## [1] 10</code></pre>
<pre class="r"><code>n.iter &lt;- 10                   # another alternative!
count &lt;- 0
for(i in 1:n.iter){
  count &lt;- count+1            # assign a new value of count equal to the old value of count plus 1
  print(count)
}</code></pre>
<pre><code>## [1] 1
## [1] 2
## [1] 3
## [1] 4
## [1] 5
## [1] 6
## [1] 7
## [1] 8
## [1] 9
## [1] 10</code></pre>
<p>Take the first FOR loop above. Here, “i” is the <em>iteration variable</em> and “1:n.iter” is the <em>iteration vector</em>:</p>
<pre class="r"><code>  # closer look at iteration vector:
1:n.iter</code></pre>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
<p>Essentially, R starts this FOR loop by setting the value of the placeholder <em>iteration variable</em> “i” to the first value of the <em>iteration vector</em> (i.e., the value 1). It then runs the two commands in the body of the for loop [count &lt;- count+1; print(count)]. Then, it sets the iteration variable “i” to the next value in the <em>iteration vector</em> (i.e., the value 2) and runs the commands again. It keeps doing this until it reaches the end of the iteration vector, at which point it stops!</p>
<p>It is often useful to reference the iteration variable directly within the FOR loop. Here are some examples:</p>
<pre class="r"><code>## Using the iteration variable &quot;i&quot; within the for loop:

count &lt;- 0
for(i in 1:n.iter){
  count &lt;- count+i            # assign a new value of count equal to the old value of count + i
  print(count)
}</code></pre>
<pre><code>## [1] 1
## [1] 3
## [1] 6
## [1] 10
## [1] 15
## [1] 21
## [1] 28
## [1] 36
## [1] 45
## [1] 55</code></pre>
<pre class="r"><code>## A for-loop for dependent sequence (here, the Fibonacci sequence)
n.iter &lt;- 10
x &lt;- rep(0, n.iter)           # set up vector of all zeros
x[1] &lt;- 1                     # assign x_1  &lt;-  1
x[2] &lt;- 1                     # assign x_2 = 0
for(i in 3:n.iter){
  x[i] &lt;- x[i-1]+x[i-2]       # x_i = x_(i-1) + x_(i-2)
}
x</code></pre>
<pre><code>##  [1]  1  1  2  3  5  8 13 21 34 55</code></pre>
<div id="iterating-using-the-apply-family-of-functions-in-r" class="section level3">
<h3>Iterating using the “apply() family of functions in R”</h3>
<pre class="r"><code>###
### apply (A more efficient way to iterate)
###

W &lt;- matrix(rpois(4, 10), nrow = 2, ncol = 2)  # Create a 2X2 matrix using a Poisson distribution with lambda = 10.
W</code></pre>
<pre><code>##      [,1] [,2]
## [1,]   12    5
## [2,]   10    8</code></pre>
<pre class="r"><code>## Calculate the row means.
apply(W, 1, mean)</code></pre>
<pre><code>## [1] 8.5 9.0</code></pre>
<pre class="r"><code>## Calculate the column means.
apply(W, 2, mean)</code></pre>
<pre><code>## [1] 11.0  6.5</code></pre>
<pre class="r"><code>## Identify the column that has the largest value.
apply(W, 1, which.max)</code></pre>
<pre><code>## [1] 1 1</code></pre>
<pre class="r"><code>## Apply your own functions to each row in a matrix.
MyFunc &lt;- function(x){
    2+sum(x/5)-3/2*mean(x)^2
}
apply(W, 1, MyFunc)</code></pre>
<pre><code>## [1] -102.975 -115.900</code></pre>
<pre class="r"><code>##########
# lapply: apply a function across a list or vector

lapply(1:5,function(x) exp(x)) </code></pre>
<pre><code>## [[1]]
## [1] 2.718282
## 
## [[2]]
## [1] 7.389056
## 
## [[3]]
## [1] 20.08554
## 
## [[4]]
## [1] 54.59815
## 
## [[5]]
## [1] 148.4132</code></pre>
<pre class="r"><code>lapply(1:5, function(x) sqrt(trees$Volume[x]))</code></pre>
<pre><code>## [[1]]
## [1] 3.209361
## 
## [[2]]
## [1] 3.209361
## 
## [[3]]
## [1] 3.193744
## 
## [[4]]
## [1] 4.049691
## 
## [[5]]
## [1] 4.335897</code></pre>
<pre class="r"><code>##########
# sapply: apply a function across a list or vector, and simplify the returned object (usually returns a vector)

sapply(1:5,function(x) exp(x)) </code></pre>
<pre><code>## [1]   2.718282   7.389056  20.085537  54.598150 148.413159</code></pre>
<pre class="r"><code>#########
# tapply: summarize a vector by group (apply a summary function separately to each group)

df.new &lt;- data.frame(
  var1 = runif(10),
  group = sample(c(&quot;A&quot;,&quot;B&quot;),10,replace=T)
)
tapply(df.new$var1,df.new$group,sum)</code></pre>
<pre><code>##        A        B 
## 2.948623 1.336062</code></pre>
</div>
</div>
<div id="practice-exercises" class="section level2">
<h2>Practice exercises</h2>
<div id="using-conditional-statements" class="section level3">
<h3>Using conditional statements</h3>
<div id="reject-null-hypothesis" class="section level4">
<h4>Reject null hypothesis</h4>
<p>In traditional statistics, one of the primary goals is to compare a test statistic with a “critical value”: if the test statistic exceeds the critical value, you can reject a null hypothesis with a reasonable degree of certainty (such that the rate at which you incorrectly reject the null hypothesis remains at or below a pre-specified value, called the “alpha-level”).</p>
<p>In the example below, we simulate data (n=100) from a normal distribution with mean of 1, and we use a Student’s t-test to assess whether or not we can reject the null hypothesis that the data were derived from a distribution with mean of zero. Here, the <em>test statistic</em> is the t-statistic (representing the standardized difference of the sample mean from zero), and the <em>critical value</em> is determined as a pre-specified quantile of the “t” distribution (here, we use a two-tailed test holding alpha=0.05).</p>
<p>The act of rejecting or failing to reject a null hypothesis is an instance of conditional logic (if…then…else). Let’s see how we might implement this test in R:</p>
<pre class="r"><code>####################
####  Practice exercises ####
####################


###
### Perform hypothesis test using if...then...else
###

n.samples &lt;- 100
x &lt;- rnorm(n = n.samples, mean = 1, sd = 1) # Generate fake data from a normal distribution (using random number generator).
hist(x)</code></pre>
<p><img src="module1_4_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<pre class="r"><code>mu &lt;- mean(x)                               # Compute the sample mean.
s &lt;- sd(x)                                  # Compute the sample standard deviation.
t &lt;- mu/(s/sqrt(n.samples))                 # Calculate t-statistic (here, standardized difference of the sample mean from zero)
t.crit &lt;- qt(p = 0.975, df = 99)            # Calculate critical value for test (above which we can reject the null hypothesis with acceptable type-I error)
if (t &gt; t.crit) {
    print(&quot;reject&quot;)                        # Reject if condition holds.
} else {
    print(&quot;fail to reject&quot;)                # Fail to reject otherwise.
}</code></pre>
<pre><code>## [1] &quot;reject&quot;</code></pre>
<p>Did you successfully reject the null hypothesis? What if you set the mean to zero when you simulate the data?</p>
</div>
<div id="cleaning-up-messy-data" class="section level4">
<h4>Cleaning up messy data</h4>
<p>Sometimes (like all the time) your data will be “messy” - that is, it will have some errors (e.g., incorrect data entry) that need to be fixed prior to running an analysis. Take this example of “messy” data from a simulated occupancy study:</p>
<pre class="r"><code>###
### Clean up messy matrix using ifelse
###

## Simulate data.
observations &lt;- matrix(sample(c(&quot;Detected&quot;, &quot;NotDetected&quot;, 1, 0), 20*3, replace = TRUE), 20, 3)    # simulate detection/non-detection data over three sampling occasions

habitat &lt;- rnorm(20, 0, 2)    # simulate environmental covariate
Data &lt;- cbind(observations, habitat)       # bind into single matrix.
Data</code></pre>
<pre><code>##                                                 habitat             
##  [1,] &quot;Detected&quot;    &quot;1&quot;           &quot;Detected&quot;    &quot;-1.31838013069218&quot; 
##  [2,] &quot;Detected&quot;    &quot;Detected&quot;    &quot;NotDetected&quot; &quot;-0.959218095366536&quot;
##  [3,] &quot;1&quot;           &quot;Detected&quot;    &quot;Detected&quot;    &quot;2.31665529967448&quot;  
##  [4,] &quot;0&quot;           &quot;Detected&quot;    &quot;Detected&quot;    &quot;-0.600024626226216&quot;
##  [5,] &quot;NotDetected&quot; &quot;Detected&quot;    &quot;1&quot;           &quot;-1.19162607148504&quot; 
##  [6,] &quot;1&quot;           &quot;1&quot;           &quot;Detected&quot;    &quot;0.952650163756112&quot; 
##  [7,] &quot;NotDetected&quot; &quot;NotDetected&quot; &quot;1&quot;           &quot;3.31960806917777&quot;  
##  [8,] &quot;Detected&quot;    &quot;Detected&quot;    &quot;NotDetected&quot; &quot;-2.82432188658575&quot; 
##  [9,] &quot;NotDetected&quot; &quot;1&quot;           &quot;Detected&quot;    &quot;2.00889649628675&quot;  
## [10,] &quot;0&quot;           &quot;0&quot;           &quot;NotDetected&quot; &quot;3.37380275696964&quot;  
## [11,] &quot;1&quot;           &quot;1&quot;           &quot;NotDetected&quot; &quot;-1.38505429366756&quot; 
## [12,] &quot;Detected&quot;    &quot;NotDetected&quot; &quot;1&quot;           &quot;0.818397336733175&quot; 
## [13,] &quot;0&quot;           &quot;0&quot;           &quot;0&quot;           &quot;-1.01972896373415&quot; 
## [14,] &quot;Detected&quot;    &quot;NotDetected&quot; &quot;Detected&quot;    &quot;-2.96852211723634&quot; 
## [15,] &quot;0&quot;           &quot;0&quot;           &quot;NotDetected&quot; &quot;-2.15312731331142&quot; 
## [16,] &quot;Detected&quot;    &quot;Detected&quot;    &quot;NotDetected&quot; &quot;-2.08564204039605&quot; 
## [17,] &quot;Detected&quot;    &quot;Detected&quot;    &quot;1&quot;           &quot;-0.725906188492338&quot;
## [18,] &quot;1&quot;           &quot;1&quot;           &quot;0&quot;           &quot;3.02404054801466&quot;  
## [19,] &quot;Detected&quot;    &quot;1&quot;           &quot;NotDetected&quot; &quot;0.237107059656618&quot; 
## [20,] &quot;0&quot;           &quot;NotDetected&quot; &quot;1&quot;           &quot;0.773745221715878&quot;</code></pre>
<p>As you can see, non-detections are coded here as both “NotDetected” and “0”, and likewise, detection events also have two alternative codes. To clean up this data set, let’s do the following:</p>
<ul>
<li>Make sure that detections and non-detections are coded in a consistent manner!<br />
</li>
<li>Reduce the significant digits of the environmental covariate “Habitat”.<br />
</li>
<li>Finally, we probably want to add column names to our matrix.</li>
</ul>
<p>Note the use of the “ifelse()” function here, which is a convenient and efficient way to perform a test consecutively on an entire vector using a single line of code!</p>
<pre class="r"><code>## Clean-up data using &quot;ifelse()&quot; function
NewObs &lt;- ifelse( (Data[, 1:3] == &quot;Detected&quot;) | (Data[, 1:3] == &quot;1&quot;), 1, 0) #  The &quot;|&quot; means &quot;or.&quot; Similarly &quot;&amp;&quot; means &quot;and&quot;
NewHabitat &lt;- as.numeric(Data[, 4])  # as.numeric gets rid of quotes around habitat data.
NewHabitat &lt;- round(NewHabitat, 2)   # round rounds to number of decimals specified.
NewData &lt;- cbind(NewObs, NewHabitat) # bind the columns to form a matrix.
colnames(NewData) &lt;- c(&quot;obs1&quot;, &quot;obs2&quot;, &quot;obs3&quot;, &quot;Habitat&quot;)  # provide column names
NewData</code></pre>
<pre><code>##       obs1 obs2 obs3 Habitat
##  [1,]    1    1    1   -1.32
##  [2,]    1    1    0   -0.96
##  [3,]    1    1    1    2.32
##  [4,]    0    1    1   -0.60
##  [5,]    0    1    1   -1.19
##  [6,]    1    1    1    0.95
##  [7,]    0    0    1    3.32
##  [8,]    1    1    0   -2.82
##  [9,]    0    1    1    2.01
## [10,]    0    0    0    3.37
## [11,]    1    1    0   -1.39
## [12,]    1    0    1    0.82
## [13,]    0    0    0   -1.02
## [14,]    1    0    1   -2.97
## [15,]    0    0    0   -2.15
## [16,]    1    1    0   -2.09
## [17,]    1    1    1   -0.73
## [18,]    1    1    0    3.02
## [19,]    1    1    0    0.24
## [20,]    0    0    1    0.77</code></pre>
<p>Looks a lot better now, right!</p>
</div>
</div>
<div id="using-for-loops" class="section level3">
<h3>Using FOR loops</h3>
<p>Iteration is one of the things computers do best, and harnessing this ability is endlessly useful! Here are some examples:</p>
<div id="view-a-landscape-from-multiple-angles" class="section level4">
<h4>View a landscape from multiple angles</h4>
<p>In this example, we use a FOR loop to view the topography of a rugged landscape (using the built-in “volcano” dataset in R) from multiple perspectives.</p>
<pre class="r"><code>###
### FOR loop examples
###

#############
## EXAMPLE 1: Plot a 3D surface using data already stored in R.

Z &lt;- 2 * volcano        # Exaggerate the relief (multiply the elevation by 2)   

X &lt;- 10 * (1:nrow(Z))   # set horizontal coordinates -- 10 meter spacing (S to N)     

Y &lt;- 10 * (1:ncol(Z))   # set vertical coordinates -- 10 meter spacing (E to W)

# Z   # make sure the elevation matrix looks right

par(bg = &quot;white&quot;)
layout(matrix(c(1,1),nrow=1))
persp(X,  Y, Z, theta = 135, phi = 30, col = &quot;green3&quot;,    # &quot;persp()&quot; produces a 3D &quot;perspective plot&quot;
      scale = FALSE, ltheta = -120, shade = 0.75,
      border = NA, box = FALSE)</code></pre>
<p><img src="module1_4_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>Now let’s view from an alternative angle!</p>
<pre class="r"><code>## change the value of theta from 135 to 90 to change the viewing angle
persp(X, Y, Z, theta = 90, phi = 30, col = &quot;green3&quot;,
      scale = FALSE,  ltheta = -120, shade = 0.75,
      border = NA, box = FALSE)</code></pre>
<p><img src="module1_4_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>Now we can use a FOR loop to view this landscape from many angles. Try it!</p>
<pre class="r"><code>## Use a for-loop to help view many angles.
for(i in 1:18){
    persp(X, Y, Z, theta = i*20, phi = 30, col = &quot;green3&quot;,
          scale = FALSE,  ltheta = -120, shade = 0.75,
          border = NA, box = FALSE)
    print(i*20)
    readline()                               # Pauses the for-loop until [enter] is pushed
}</code></pre>
</div>
</div>
</div>
<div id="challenge-problems" class="section level2">
<h2>Challenge problems!</h2>
<ol style="list-style-type: decimal">
<li><p>Create a function to calculate the value of <span class="math inline">\(y\)</span> for the equation <span class="math inline">\(y = \beta_0 + \beta_1*x\)</span> for any value of <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(x\)</span>.</p></li>
<li><p>Using the function in part 1, with <span class="math inline">\(\beta_0 = 2\)</span>, and <span class="math inline">\(\beta_1= -1\)</span> use a FOR loop to calculate <span class="math inline">\(y\)</span> for the values of <span class="math inline">\(x\)</span> = 1,…,10. Plot the results.</p></li>
<li><p>Write a function that conducts a two-sided t test for a given null hypothesis. Here is a code skeleton to get you started!!</p></li>
</ol>
<pre class="r"><code>##########
# Challenge problem 3: code skeleton to get you started!   

get.t.test &lt;- function(data, mu0, alpha = 0.05) {
    n &lt;- length(data)
    mu &lt;- mean(____)
    s &lt;- ____(data)
    t &lt;- (mu-mu0)/(s/sqrt(n))
    t.crit &lt;- qt(p = (1-alpha/2), df = n-1)        # get the critical value
    if (abs(t)&gt;t.crit) {
        answer = &quot;_______&quot;
    } ____ {
        answer = &quot;Fail to reject&quot;
    }
    print(answer)
}</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Calculate the standard deviation as an index of ruggedness from the rows of the volcano elevation data “Z”, using the “apply()” function. Which row has the most rugged terrain?</li>
</ol>
<p>5: Wrap the code below in a FOR loop to simulate the sun rising and setting over the volcano data by looping over values of “lphi” (the light angle). Try replacing “readline()” with “Sys.sleep(.5)” from the example above.</p>
<pre class="r"><code>#######
# Example code to get you started with challenge problem 5... 

persp(X, Y, Z, theta = 30, phi = 30, col = &quot;green3&quot;,  lphi = ?,
                                                          scale = FALSE,  ltheta = -120, shade = 0.75,
      border = NA, box = FALSE)
print(?)
readline()</code></pre>
<p><a href="module2_1.html">–go to next module–</a></p>
</div>
<div id="more-practice-with-programming-in-r" class="section level2">
<h2>More practice with programming in R</h2>
<div id="test-the-central-limit-theorem" class="section level4">
<h4>Test the Central Limit Theorem!</h4>
<p>In this example, we test the famous <a href="https://en.wikipedia.org/wiki/Central_limit_theorem">Central Limit Theorem (CLT)</a> using repeated simulations.</p>
<p>Specifically, as we collect more samples from an arbitrary distribution, the sample mean (e.g., the mean of all the sample means) should converge on the true mean (here, equal to 5).</p>
<p>To test this, let’s first write some <em>pseudocode</em> for how to perform this operation:</p>
<ol style="list-style-type: decimal">
<li>Specify the number of hypothetical repeat samples to draw<br />
</li>
<li>Specify the sample size for each hypothetical repeat sample<br />
</li>
<li>Specify the min and max of the “true” (uniform) population from which we will sample</li>
<li>For each hypothetical sampling experiment:
<ol style="list-style-type: lower-alpha">
<li>Draw a random sample from the known distribution<br />
</li>
<li>Compute and store the sample mean<br />
</li>
</ol></li>
<li>Visualize the distribution of sample means. Evaluate whether the sample means tend toward the true mean…</li>
</ol>
<p>Here we translate the pseudocode into real R code!</p>
<pre class="r"><code>##################
## EXAMPLE 2: Use a FOR loop to create a simulation to test the central limit theorem (CLT).

n.iter &lt;- 1000                                # large number of hypothetical &quot;repeat samples.&quot;
sample.size &lt;- 30                             # Sample size of 30 from each repeat sample.
min &lt;- 2                                       # True population minimum of 2.
max &lt;- 6                                       # True population maximum of 6.
means &lt;- numeric(n.iter)                      # Initialize empty vector to store the sample means.
for(i in 1:n.iter){                           # For each of the repeat samples...
    sample &lt;- runif(sample.size,min=min,max=max)     # draw a random sample from the true population
    means[i] &lt;- mean(sample)                # and store the sample mean.
}
hist(means)                                # Histogram of all the means.
abline(v = mean(means), col = 2, lwd = 4)          # The mean of the means is close to the true mean of 4.</code></pre>
<p><img src="module1_4_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<pre class="r"><code>plot(density(means), main = &quot;&quot;)
abline(v = mean(means), col = 2, lwd = 4)</code></pre>
<p><img src="module1_4_files/figure-html/unnamed-chunk-25-2.png" width="672" /></p>
<pre class="r"><code>mean(means)                                # Close to true mean of 5</code></pre>
<pre><code>## [1] 3.99954</code></pre>
</div>
<div id="practice-putting-it-all-together" class="section level3">
<h3>Practice putting it all together!</h3>
<p>To make sure we can apply the fundamental components of programming (iterative loops and functions), let’s work out an example that uses both!</p>
<div id="logistic-population-growth-example" class="section level4">
<h4>Logistic population growth example</h4>
<p>Here we model the growth/dynamics of a wild population using a classical <em>logistic</em> (S-shaped) population growth model:</p>
<p>To get some more practice with functions, let’s first write a function to compute the expected rate of population growth on the basis of <span class="math inline">\(r\)</span> (intrinsic rate of population growth), <span class="math inline">\(K\)</span> (carrying capacity), and <span class="math inline">\(P_0\)</span> (current population size). The logistic growth equation can be written mathematically as:</p>
<p><span class="math inline">\(P_{t+1}=P_t+r\cdot P0 \cdot (1-\frac{P0}{K})\)</span></p>
<p>Let’s implement this equation as a function in R:</p>
<pre class="r"><code>##############
##  Logistic population growth example (uses function and for loop)


## Logistic growth function: calculate population size using logistic growth model.
  # K = carrying capacity.
  # r = intrinsic growth rate
  # P0 = initial population size

logistic.growth &lt;- function(r, P0, K){            
    dpdt &lt;- r*P0*(1-P0/K)                   # implement logistic growth equation
    P0+dpdt                                   
}                                           
logistic.growth(r = .5, P0 = 10, K = 100)   # try out the new function!</code></pre>
<pre><code>## [1] 14.5</code></pre>
<p>Now, we can use a FOR loop simulate population growth over many years:</p>
<pre class="r"><code>## Logistic growth function within a for-loop

years &lt;- 20                                   # How many years we want to calc population size.
pop.size &lt;- numeric(years)                    # Empty vector to store population size.
pop.size[1] &lt;- 5                              # Starting population size (P0).
for(i in 1:(years-1)){                     # Function within a FOR loop!
    pop.size[i+1] &lt;- logistic.growth(r = 0.5, P0 = pop.size[i], K = 100)
}
plot(1:years, pop.size, type = &#39;l&#39;,
     xlab = &quot;Years&quot;, ylab = &quot;Population Size&quot;)</code></pre>
<p><img src="module1_4_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<p>And finally, we could wrap this all up in a more complex function that simulates across years and produces a plot! That way, we could run an entire population simulation with a single line of code. Let’s try it!</p>
<pre class="r"><code>## A more complex function that outputs a plot.
plot.logistic.growth &lt;- function(r, P, K, years){
    pop.size[1] &lt;- P
    for(i in 1:(years-1)){
        pop.size[i+1] &lt;- P+r*P*(1-P/K)
        P &lt;- pop.size[i+1]
    }
    plot(1:years, pop.size, type = &#39;l&#39;, xlab = &quot;Years&quot;,
         ylab = &quot;Population Size&quot;,
         main = paste(&quot;r = &quot;, r, &quot;K = &quot;, K))
}

plot.logistic.growth(r = 0.5, P = 10, K = 100, years = 20)</code></pre>
<p><img src="module1_4_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<pre class="r"><code>par(mfrow = c(2, 2), mar = c(4, 4, 1, 1))                  # Multi-figure (mf) plot with 2 rows and 2 columns.
plot.logistic.growth(r = 0.1, P = 10, K = 100, years = 20)   # Change the values of r and quickly print plots.
plot.logistic.growth(r = 0.2, P = 10, K = 100, years = 20)
plot.logistic.growth(r = 0.3, P = 10, K = 100, years = 20)
plot.logistic.growth(r = 0.5, P = 10, K = 100, years = 20)</code></pre>
<p><img src="module1_4_files/figure-html/unnamed-chunk-28-2.png" width="672" /></p>
<pre class="r"><code>par(mfrow = c(1, 1))                               # Return to a 1X1 plot.</code></pre>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
