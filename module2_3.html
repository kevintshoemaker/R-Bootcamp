<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Statistics" />


<title>Submodule 2.3</title>

<script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/journal.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">UNR R workshop, Fall 2022</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Workshop #1: getting started
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="module1_1.html">Submodule 1.1: working with objects</a>
    </li>
    <li>
      <a href="module1_2.html">Submodule 1.2: managing data</a>
    </li>
    <li>
      <a href="module1_3.html">Submodule 1.3: plotting in ggplot2</a>
    </li>
    <li>
      <a href="module1_4.html">Submodule 1.4: data wrangling</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Workshop #2: beyond the basics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="module2_1.html">Submodule 2.1: R packages</a>
    </li>
    <li>
      <a href="module2_2.html">Submodule 2.2: Programming in R</a>
    </li>
    <li>
      <a href="module2_3.html">Submodule 2.3: Stats in R</a>
    </li>
    <li>
      <a href="module2_4.html">Submodule 2.4: Spatial analysis in R</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Data sets
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="data.dat">Example: tab-separated data</a>
    </li>
    <li>
      <a href="data.csv">Example: comma-separated data</a>
    </li>
    <li>
      <a href="data.txt">Example: whitespace-separated data</a>
    </li>
    <li>
      <a href="data_missing.txt">Example: missing data</a>
    </li>
    <li>
      <a href="MTMetStations.csv">Meteorological Data</a>
    </li>
    <li>
      <a href="sculpineggs.csv">Sculpin Data</a>
    </li>
    <li>
      <a href="turtle_data.txt">Turtle Data</a>
    </li>
    <li>
      <a href="geneData.csv">Gene Data</a>
    </li>
    <li>
      <a href="reptiles.csv">Reptile Data</a>
    </li>
    <li>
      <a href="comm_data.txt">Comm Data</a>
    </li>
    <li>
      <a href="data.zip">GIS Data</a>
    </li>
  </ul>
</li>
<li>
  <a href="Links.html">Links</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Submodule 2.3</h1>
<h4 class="author">Statistics</h4>
<h4 class="date">Fall 2022</h4>

</div>


<div id="load-script-for-submodule-2.3" class="section level2">
<h2>Load script for submodule #2.3</h2>
<ol style="list-style-type: decimal">
<li><p>Click <a href="module2_3.R">here</a> to download the script! Save
the script to your working directory (R Project directory).</p></li>
<li><p>Load your script in your RStudio Project. To do this, open your
RStudio Project and click on the folder icon in the toolbar at the top
and load your script.</p></li>
</ol>
</div>
<div id="statistics-in-r" class="section level2">
<h2>Statistics in R!</h2>
<p>R is a programming environment developed specifically for working
with data and running statistical analyses! It seems about time to run
some stats in R!</p>
<p>As in the previous submodule, we will primarily be working in base R
instead of the tidyverse here. The tidyverse is great for preparing data
for analysis, but the analyses themselves tend to occur outside of the
tidyverse!</p>
<div id="load-data" class="section level3">
<h3>Load data</h3>
<p>First, download the sculpin eggs data <a
href="sculpineggs.csv">here</a> and save this to your working
directory.</p>
<pre class="r"><code># STATISTICS! ------------------

#  Load Data ------------------

sculpin.df &lt;- read.csv(&quot;sculpineggs.csv&quot;)

head(sculpin.df)</code></pre>
<pre><code>##   FEMWT NUMEGGS
## 1    14      61
## 2    17      37
## 3    24      65
## 4    25      69
## 5    27      54
## 6    33      93</code></pre>
</div>
<div id="summary-statistics" class="section level3">
<h3>Summary statistics</h3>
<p>Let’s start by generating summary statistics, some of which are the
same ones that are displayed by the “summary()” function. Most of the
function names are pretty intuitive, like mean() and median():</p>
<pre class="r"><code># Summary Statistics ------------------

mean(sculpin.df$NUMEGGS)      # compute sample mean</code></pre>
<pre><code>## [1] 76.54545</code></pre>
<pre class="r"><code>median(sculpin.df$NUMEGGS)    # compute sample median</code></pre>
<pre><code>## [1] 87</code></pre>
<pre class="r"><code>min(sculpin.df$NUMEGGS)       # sample minimum</code></pre>
<pre><code>## [1] 37</code></pre>
<pre class="r"><code>max(sculpin.df$NUMEGGS)       # sample maximum</code></pre>
<pre><code>## [1] 100</code></pre>
<pre class="r"><code>range(sculpin.df$NUMEGGS)     # both min and max.</code></pre>
<pre><code>## [1]  37 100</code></pre>
<pre class="r"><code>quantile(sculpin.df$NUMEGGS,0.5)            # compute sample median using quantile function</code></pre>
<pre><code>## 50% 
##  87</code></pre>
<pre class="r"><code>quantile(sculpin.df$NUMEGGS,c(0.25,0.75))   # compute sample quartiles</code></pre>
<pre><code>##  25%  75% 
## 63.0 91.5</code></pre>
<pre class="r"><code>var(sculpin.df$NUMEGGS)           # sample variance</code></pre>
<pre><code>## [1] 418.8727</code></pre>
<pre class="r"><code>sd(sculpin.df$NUMEGGS)            # sample standard deviation</code></pre>
<pre><code>## [1] 20.46638</code></pre>
<pre class="r"><code>sd(sculpin.df$NUMEGGS)^2          # another way to compute variance</code></pre>
<pre><code>## [1] 418.8727</code></pre>
<pre class="r"><code>apply(sculpin.df,2,mean)       # column means of data frame </code></pre>
<pre><code>##    FEMWT  NUMEGGS 
## 30.36364 76.54545</code></pre>
<pre class="r"><code>apply(sculpin.df,2,median)     # column medians of data frame</code></pre>
<pre><code>##   FEMWT NUMEGGS 
##      33      87</code></pre>
<pre class="r"><code># maybe you&#39;d like to use some tidyverse functions instead:

sculpin.df %&gt;% summarize(across(everything(),mean) ) </code></pre>
<pre><code>##      FEMWT  NUMEGGS
## 1 30.36364 76.54545</code></pre>
<pre class="r"><code>########
# Or just use the &quot;summary()&quot; function!

summary(sculpin.df) # provides a set of summary statistics for all columns in a data frame. </code></pre>
<pre><code>##      FEMWT          NUMEGGS      
##  Min.   :14.00   Min.   : 37.00  
##  1st Qu.:24.50   1st Qu.: 63.00  
##  Median :33.00   Median : 87.00  
##  Mean   :30.36   Mean   : 76.55  
##  3rd Qu.:38.50   3rd Qu.: 91.50  
##  Max.   :42.00   Max.   :100.00</code></pre>
<p>If your data have missing values (coded as ‘NA’ in R), some
statistical functions won’t work properly unless you specify an
“na.rm=TRUE” argument (click <a href="data_missing.txt">here</a> if you
don’t already have the test dataset with missing values):</p>
<pre class="r"><code># Deal with missing data --------------

newdf &lt;- read.table(file=&quot;data_missing.txt&quot;, sep=&quot;\t&quot;, header=T)  # load dataset with missing data

mean(newdf$Export)</code></pre>
<pre><code>## [1] NA</code></pre>
<pre class="r"><code>mean(newdf$Export,na.rm = TRUE)</code></pre>
<pre><code>## [1] 10.22222</code></pre>
</div>
<div id="visual-exploration" class="section level3">
<h3>Visual exploration</h3>
<p>Plots (see beginning of module) take data exploration to the next
level- we can start to discern patterns and identify outliers visually,
giving us cues for further analyses we might want to perform.</p>
<pre class="r"><code>#  Plot data  (base R)
# 
# hist(sculpin.df$NUMEGGS)
# plot(x = sculpin.df$FEMWT,y = sculpin.df$NUMEGGS)

#  Ggplot alternative:

ggplot(sculpin.df,aes(NUMEGGS)) + geom_histogram(bins=5)</code></pre>
<p><img src="module2_3_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre class="r"><code>ggplot(sculpin.df,aes(FEMWT,NUMEGGS)) + geom_point()</code></pre>
<p><img src="module2_3_files/figure-html/unnamed-chunk-5-2.png" width="672" /></p>
</div>
<div id="linear-regression" class="section level3">
<h3>Linear Regression</h3>
<p>The plot above suggests a fairly strong relationship between sculpin
weight (“FEMWT”) and number of eggs (“NUMEGGS”). Let’s try to model this
relationship!</p>
<p>Note the use of the generic “summary()” function below, which returns
something very different when the input object is a linear model
vs. when the input object is a data frame!</p>
<p>Also note the use of the “predict()” function, which not only allows
you to use the model to make predictions, but also reports the
uncertainty bounds on these predictions (via confidence or prediction
intervals).</p>
<pre class="r"><code>#  Linear Regression   -------------------

m1 &lt;- lm(NUMEGGS ~ FEMWT, data=sculpin.df)      # fit linear regression model

summary(m1)                             # view model summary</code></pre>
<pre><code>## 
## Call:
## lm(formula = NUMEGGS ~ FEMWT, data = sculpin.df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -16.2556  -3.8700   0.3543   4.5448  15.0538 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  19.7668    10.5497   1.874 0.093747 .  
## FEMWT         1.8700     0.3325   5.624 0.000324 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 10.15 on 9 degrees of freedom
## Multiple R-squared:  0.7785, Adjusted R-squared:  0.7539 
## F-statistic: 31.63 on 1 and 9 DF,  p-value: 0.0003242</code></pre>
<pre class="r"><code>summary(m1)$r.squared                   # extract R-squared</code></pre>
<pre><code>## [1] 0.7784851</code></pre>
<pre class="r"><code>confint(m1)                             # confidence intervals for intercept and slope</code></pre>
<pre><code>##                 2.5 %    97.5 %
## (Intercept) -4.098376 43.632008
## FEMWT        1.117797  2.622113</code></pre>
<pre class="r"><code>AIC(m1)                                 # report AIC (Akaike&#39;s Information Criterion, used to perform model selection) </code></pre>
<pre><code>## [1] 86.00155</code></pre>
<pre class="r"><code>plot(x = sculpin.df$FEMWT,y = sculpin.df$NUMEGGS)    # plot data
abline(m1)                                           # plot line of best fit</code></pre>
<p><img src="module2_3_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<pre class="r"><code># Use the &quot;predict()&quot; function! --------------

nd &lt;- data.frame(FEMWT = 30)                   # create new data frame to predict number of eggs at FEMWT of 30
predict(m1,newdata=nd)                         # make prediction</code></pre>
<pre><code>##        1 
## 75.86547</code></pre>
<pre class="r"><code>predict(m1,newdata=nd,interval=&quot;confidence&quot;)   # make prediction and get confidence interval</code></pre>
<pre><code>##        fit      lwr      upr
## 1 75.86547 68.93463 82.79631</code></pre>
<pre class="r"><code>predict(m1,newdata=nd,interval=&quot;prediction&quot;)   # make prediction and get prediction interval</code></pre>
<pre><code>##        fit      lwr      upr
## 1 75.86547 51.87347 99.85748</code></pre>
</div>
<div id="model-selection-example" class="section level3">
<h3>Model selection example</h3>
<p>Sometimes we may be uncertain which model is “best”. In this case, we
run a set of <strong>plausible models</strong> and compare these models
using metrics of model fit and performance, like AIC (Akaike’s
Information Criterion).</p>
<p>Note the use of the “I()” within the formula specification (i.e., the
“[response] ~ [predictors]” statement). Using “I()” causes R to
interpret what’s inside the parentheses literally (“as is”), instead of
using R’s formula shorthands. For instance, you might try running a
linear model (“lm()”) in the following two ways and see how the results
differ!</p>
<p>Click <a
href="http://faculty.washington.edu/jmiyamot/p448/hahnpr%20r%20formula%20notation.pdf">here</a>
for more information on R’s formula notation.</p>
<pre class="r"><code>#  Explore the use of the &quot;I()&quot; syntax to interpret mathematical expressions literally (as is) within formulas. 

mod_noI &lt;- lm(NUMEGGS ~ FEMWT^2, data=sculpin.df)                  # fit linear regression model. But the &quot;^2&quot; doesn&#39;t seem to do anything here? What happened?
summary(mod_noI)

mod_withI &lt;- lm(NUMEGGS ~ I(FEMWT^2), data=sculpin.df)                  # fit linear regression model
summary(mod_withI)

# try a model with a polynomial fit
mod_withpoly &lt;- lm(NUMEGGS ~ poly(FEMWT,2),data=sculpin.df)
summary(mod_withpoly)

# try a log transformation on the response:

mod_logtrans &lt;- lm(log(NUMEGGS) ~ FEMWT, data=sculpin.df) 
summary(mod_logtrans)</code></pre>
<p>Below we perform AIC model selection and also visualize the
differences between these alternative linear models.</p>
<p>A flexible method for visualizing the fit of alternative linear
models involves overlaying predictions from each model (using the
“predict()” function) on a basic scatterplot:</p>
<pre class="r"><code>#  Model selection example -------------------

m1 &lt;- lm(NUMEGGS ~ FEMWT, data=sculpin.df)                  # fit linear regression model
summary(m1)

m2 &lt;- lm(NUMEGGS ~ 1, data=sculpin.df)                      # fit linear regression with intercept only (null model)
summary(m2)

m3 &lt;- lm(NUMEGGS ~ poly(FEMWT,2), data=sculpin.df)           # fit polynomial regression
summary(m3)</code></pre>
<pre class="r"><code>plot(NUMEGGS ~ FEMWT,data=sculpin.df)                      # plot data
abline(m1,col=&quot;black&quot;)                                     # plot line of best fit
abline(m2,col=&quot;red&quot;)                                       # plot intercept only model

# Use &#39;predict&#39; to draw lines on scatterplot  -----------------
#  Here&#39;s a flexible method for drawing any arbitrary modeled relationship!
nd &lt;- data.frame(FEMWT = seq(10,45,by=0.1))        # create new data frame to predict number of eggs from FEMWT of 10 to 45 by increments of 0.1
NUMEGGS.pred &lt;- predict(m3,newdata=nd,interval=&quot;confidence&quot;)             # make prediction using &quot;predict()&quot; function
lines(nd$FEMWT,NUMEGGS.pred[,1],col=&quot;green&quot;)  # plot sqrt model (note the use of the &quot;lines()&quot; function to draw a line!)</code></pre>
<p><img src="module2_3_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r"><code># some of you might want to try recreating this plot using gglot!

# Perform model selection! -------------

#Compare models using AIC
AIC(m1)</code></pre>
<pre><code>## [1] 86.00155</code></pre>
<pre class="r"><code>AIC(m2)</code></pre>
<pre><code>## [1] 100.5815</code></pre>
<pre class="r"><code>AIC(m3)</code></pre>
<pre><code>## [1] 87.76849</code></pre>
<pre class="r"><code># which model has the lowest AIC?

#  And finally, here&#39;s how you can draw a confidence interval or prediction interval around a non-linear regression relationship!

plot(NUMEGGS ~ FEMWT,data=sculpin.df)                      # plot data
NUMEGGS.confint &lt;- predict(m3,newdata=nd,interval=&quot;confidence&quot;)             # use &quot;predict()&quot; function to compute the confidence interval!
lines(nd$FEMWT,NUMEGGS.confint[,&quot;fit&quot;],col=&quot;green&quot;,typ=&quot;l&quot;,lwd=2)  # plot fitted sqrt model
lines(nd$FEMWT,NUMEGGS.confint[,&quot;lwr&quot;],col=&quot;green&quot;,typ=&quot;l&quot;,lty=2)  # plot fitted sqrt model
lines(nd$FEMWT,NUMEGGS.confint[,&quot;upr&quot;],col=&quot;green&quot;,typ=&quot;l&quot;,lty=2)  # plot fitted sqrt model</code></pre>
<p><img src="module2_3_files/figure-html/unnamed-chunk-9-2.png" width="672" /></p>
<pre class="r"><code># alternative using ggplot:
NUMEGGS.confint2 &lt;- as_tibble(cbind(nd,NUMEGGS.confint))
ggplot() %&gt;% +
  geom_point(data=sculpin.df,mapping=aes(FEMWT,NUMEGGS)) +
  geom_path(data=NUMEGGS.confint2,aes(x=FEMWT,y=fit)) +
  geom_ribbon(data=NUMEGGS.confint2,aes(x=FEMWT,ymin=lwr,ymax=upr),alpha=0.5)</code></pre>
<p><img src="module2_3_files/figure-html/unnamed-chunk-9-3.png" width="672" /></p>
</div>
</div>
<div id="challenge-exercises" class="section level2">
<h2>Challenge exercises</h2>
<ol style="list-style-type: decimal">
<li>Fit a polynomial regression model with NUMEGGS as the response and
<code>poly(FEMWT,3)</code> as the response. Plot the results by
overlaying the regression line on a scatterplot using ggplot2. The
results should look like this:</li>
</ol>
<p><img src="module2_3_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<ol start="2" style="list-style-type: decimal">
<li>Use the model you built in part 1 to predict the number of eggs for
FEMWT=5. What is the 95% confidence interval around this prediction? Is
this prediction biologically reasonable?</li>
</ol>
<pre class="r"><code># CHALLENGE EXERCISES   -------------------------------------

#1. Fit a polynomial regression model with NUMEGGS as the response and `poly(FEMWT,3)` as the response. Plot the results by overlaying the regression line on a scatterplot using ggplot2.
#
#2. Use the model you built in part 1 to predict the number of eggs for FEMWT=5. What is the 95% confidence interval around this prediction? Is this prediction biologically reasonable?</code></pre>
<p><a href="module2_4.html">–go to next submodule–</a></p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
